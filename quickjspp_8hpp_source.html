<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuickJSPP: quickjspp.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QuickJSPP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">quickjspp.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="quickjspp_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">pragma</span> <span class="preprocessor">once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;quickjs/quickjs.h&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;quickjs/quickjs-libc.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">vector</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">string_view</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">string</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">cassert</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">memory</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">cstddef</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">algorithm</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">tuple</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">functional</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">stdexcept</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="namespaceqjs.html">   17</a></span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs.html">qjs</a> {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/** A custom allocator that uses js_malloc_rt and js_free_rt</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html">   22</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1allocator.html">allocator</a></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">   24</a></span>&#160;    JSRuntime * <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a4f1a419a019f08b1b2ff3e44be227d34">   25</a></span>&#160;    <span class="keyword">using</span> value_type = T;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a46362986ca858018835ac9f19f5d78b4">   26</a></span>&#160;    <span class="keyword">using</span> propagate_on_container_move_assignment = std::true_type;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a557b2f6743458e679186f553e96a202c">   27</a></span>&#160;    <span class="keyword">using</span> propagate_on_container_copy_assignment = std::true_type;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a5a34a3f4872a04a17363e892c5da5f62">   29</a></span>&#160;    <span class="keyword">constexpr</span> <a class="code" href="structqjs_1_1allocator.html#a5a34a3f4872a04a17363e892c5da5f62">allocator</a>(JSRuntime * rt) <span class="keyword">noexcept</span> : <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>{rt}</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {}</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a18001b399a7e0a993ac9c839ebfe691c">   32</a></span>&#160;    <a class="code" href="structqjs_1_1allocator.html#a18001b399a7e0a993ac9c839ebfe691c">allocator</a>(JSContext * ctx) <span class="keyword">noexcept</span> : <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>{<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a><a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">(</a>ctx<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">)</a>}</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {}</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> U&gt;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a236f7962a53547473290e634b20e7682">   36</a></span>&#160;    <span class="keyword">constexpr</span> <a class="code" href="structqjs_1_1allocator.html#a236f7962a53547473290e634b20e7682">allocator</a>(<span class="keyword">const</span> <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;U&gt;&amp; other) <span class="keyword">noexcept</span> : <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>{other.rt}</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a3c7a430d70a4efb5305a3fcfda56b2a4">   39</a></span>&#160;    [[<a class="code" href="structqjs_1_1allocator.html">nodiscard</a>]] T * <a class="code" href="structqjs_1_1allocator.html#a3c7a430d70a4efb5305a3fcfda56b2a4">allocate</a>(std::size_t n)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">if</span>(<span class="keyword">auto</span> p = <span class="keyword">static_cast</span>&lt;T *&gt;(js_malloc_rt(<a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>, n * <span class="keyword">sizeof</span>(T)))) <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">throw</span> std::bad_alloc();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#af3540347ff540edef984e18afb7c8b24">   45</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1allocator.html#af3540347ff540edef984e18afb7c8b24">deallocate</a>(T * p, std::size_t) <span class="keyword">noexcept</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    { js_free_rt(<a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a>, p); }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> U&gt;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a1ecbd6cbf9dbe963b1b13ce47d33cd7e">   49</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structqjs_1_1allocator.html#a1ecbd6cbf9dbe963b1b13ce47d33cd7e">operator</a> ==(<span class="keyword">const</span> <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;U&gt;&amp; other) <span class="keyword">const</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    { <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a> == other.rt; }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> U&gt;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structqjs_1_1allocator.html#a1657b03f6a4f44a28aa40835b5cee763">   53</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structqjs_1_1allocator.html#a1657b03f6a4f44a28aa40835b5cee763">operator</a> !=(<span class="keyword">const</span> <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;U&gt;&amp; other) <span class="keyword">const</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    { <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">rt</a> != other.rt; }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;};</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/** Exception type.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * Indicates that exception has occured in JS context.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classqjs_1_1exception.html">   59</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classqjs_1_1exception.html">exception</a> {};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/** Javascript conversion traits.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * Describes how to convert type R to/from JSValue. Second template argument can be used for SFINAE/enable_if type filters.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">typename</span> <span class="comment">/*_SFINAE*/</span> = <span class="keywordtype">void</span>&gt;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits.html">   65</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/** Create an object of C++ type R given JSValue v and JSContext.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">     * This function is intentionally not implemented. User should implement this function for their own type.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">     * @param v This value is passed as JSValueConst so it should be freed by the caller.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     * @throws exception in case of conversion error</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">static</span> R <a class="code" href="structqjs_1_1js__traits.html#a4e5cec13ad1a12540908cff4feb6a2da">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/** Create JSValue from an object of type R and JSContext.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">     * This function is intentionally not implemented. User should implement this function for their own type.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">     * @return Returns JSValue which should be freed by the caller or JS_EXCEPTION in case of error.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits.html#af5c423e9b466ada685a39ac2dd5d2934">wrap</a>(JSContext * ctx, R value);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;};</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/** Conversion traits for JSValue (identity).</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01JSValue_01_4.html">   83</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;JSValue&gt;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01JSValue_01_4.html#a6097b6ac58491915d24ac160b001f030">   85</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01JSValue_01_4.html#a6097b6ac58491915d24ac160b001f030">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v) <span class="keyword">noexcept</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">(</a>ctx<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">,</a> v<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">)</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01JSValue_01_4.html#abfff1cf9eaa513adad29c9f1122f3dc2">   90</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01JSValue_01_4.html#abfff1cf9eaa513adad29c9f1122f3dc2">wrap</a>(JSContext * ctx, JSValue v) <span class="keyword">noexcept</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> v;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;};</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/** Conversion traits for integers.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Int&gt;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;Int, std::enable_if_t&lt;std::is_integral_v&lt;Int&gt; &amp;&amp; <span class="keyword">sizeof</span>(Int) &lt;= <span class="keyword">sizeof</span>(int64_t)&gt;&gt;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/// @throws exception</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">static</span> Int unwrap(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<span class="keyword">sizeof</span>(Int) &gt; <span class="keyword">sizeof</span>(int32_t))</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            int64_t r;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">JS_ToInt64</a><a class="code" href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">(</a>ctx<a class="code" href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">,</a> &amp;r<a class="code" href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">,</a> v<a class="code" href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">)</a>)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">static_cast</span>&lt;Int&gt;(r);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            int32_t r;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">JS_ToInt32</a><a class="code" href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">(</a>ctx<a class="code" href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">,</a> &amp;r<a class="code" href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">,</a> v<a class="code" href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">)</a>)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">static_cast</span>&lt;Int&gt;(r);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">static</span> JSValue wrap(JSContext * ctx, Int i) <span class="keyword">noexcept</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;Int, uint32_t&gt; || <span class="keyword">sizeof</span>(Int) &gt; <span class="keyword">sizeof</span>(int32_t))</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">return</span> JS_NewInt64(ctx, <span class="keyword">static_cast</span>&lt;Int&gt;(i));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">return</span> JS_NewInt32(ctx, <span class="keyword">static_cast</span>&lt;Int&gt;(i));</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;};</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/** Conversion traits for boolean.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keywordtype">bool</span>&gt;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> unwrap(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v) <span class="keyword">noexcept</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#a525bb5bdbab2566313d9bcd876838d9d">JS_ToBool</a><a class="code" href="quickjs_8c.html#a525bb5bdbab2566313d9bcd876838d9d">(</a>ctx<a class="code" href="quickjs_8c.html#a525bb5bdbab2566313d9bcd876838d9d">,</a> v<a class="code" href="quickjs_8c.html#a525bb5bdbab2566313d9bcd876838d9d">)</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">static</span> JSValue wrap(JSContext * ctx, <span class="keywordtype">bool</span> i) <span class="keyword">noexcept</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#a93abffa925714e249a6aa2f4ae7900f6">JS_NewBool</a><a class="code" href="quickjs_8h.html#a93abffa925714e249a6aa2f4ae7900f6">(</a>ctx<a class="code" href="quickjs_8h.html#a93abffa925714e249a6aa2f4ae7900f6">,</a> i<a class="code" href="quickjs_8h.html#a93abffa925714e249a6aa2f4ae7900f6">)</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;};</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/** Conversion trait for void.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keywordtype">void</span>&gt;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">/// @throws exception if jsvalue is neither undefined nor null</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> unwrap(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> value)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a>value<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;};</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/** Conversion traits for float64/double.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keywordtype">double</span>&gt;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">/// @throws exception</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> unwrap(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordtype">double</span> r;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">JS_ToFloat64</a><a class="code" href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">(</a>ctx<a class="code" href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">,</a> &amp;r<a class="code" href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">,</a> v<a class="code" href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">)</a>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">static</span> JSValue wrap(JSContext * ctx, <span class="keywordtype">double</span> i) <span class="keyword">noexcept</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#ae91f44bd7249613050c18c7133702c67">JS_NewFloat64</a><a class="code" href="quickjs_8h.html#ae91f44bd7249613050c18c7133702c67">(</a>ctx<a class="code" href="quickjs_8h.html#ae91f44bd7249613050c18c7133702c67">,</a> i<a class="code" href="quickjs_8h.html#ae91f44bd7249613050c18c7133702c67">)</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;};</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a> {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/** Fake std::string_view which frees the string on destruction.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">class</span> js_string : <span class="keyword">public</span> std::string_view</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">using</span> Base = std::string_view;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    JSContext * ctx = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">friend</span> <span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::string_view&gt;;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    js_string(JSContext * ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> * ptr, std::size_t len) : Base(ptr, len), ctx(ctx)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {}</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    js_string(Args&amp;&amp; ... args) : Base(std::forward&lt;Args&gt;(args)...), ctx(<span class="keywordtype">nullptr</span>)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    {}</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    js_string(<span class="keyword">const</span> js_string&amp; other) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    operator <span class="keyword">const</span> <span class="keywordtype">char</span> * () <span class="keyword">const</span> {</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="namespaceqjs.html#a547e49f6c831dc764b7ca71096d68637">  201</a></span>&#160;        <span class="keywordflow">return</span> <span class="keyword">this</span>-&gt;data();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="namespaceqjs.html#a0b13a25aec789e76e1f65a109faaf3f7">  204</a></span>&#160;    ~<a class="code" href="namespaceqjs.html#a0b13a25aec789e76e1f65a109faaf3f7">js_string</a>()</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span>(ctx)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="quickjs_8c.html#ae0bc4f65da64810facb2cb9e476eda2e">JS_FreeCString</a><a class="code" href="quickjs_8c.html#ae0bc4f65da64810facb2cb9e476eda2e">(</a>ctx<a class="code" href="quickjs_8c.html#ae0bc4f65da64810facb2cb9e476eda2e">,</a> <span class="keyword">this</span>-&gt;data()<a class="code" href="quickjs_8c.html#ae0bc4f65da64810facb2cb9e476eda2e">)</a>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;};</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;} <span class="comment">// namespace detail</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/** Conversion traits from std::string_view and to detail::js_string. */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html">  214</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::string_view&gt;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">  216</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::js_string <a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        size_t plen;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> * ptr = <a class="code" href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">JS_ToCStringLen</a><a class="code" href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">(</a>ctx<a class="code" href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">,</a> &amp;plen<a class="code" href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">,</a> v<a class="code" href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">)</a>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span>(!ptr)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::js_string{ctx, ptr, plen};</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#ad9dac01710453b7af63a997961c1fa6a">  225</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#ad9dac01710453b7af63a997961c1fa6a">wrap</a>(JSContext * ctx, std::string_view str) <span class="keyword">noexcept</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">JS_NewStringLen</a><a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">(</a>ctx<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">,</a> str.data()<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">,</a> str.size()<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">)</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;};</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/** Conversion traits for std::string */</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="comment">// slower</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html">  233</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::string&gt;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#a9511dd47284884284b365ff1bd3de9d5">  235</a></span>&#160;    <span class="keyword">static</span> std::string <a class="code" href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#a9511dd47284884284b365ff1bd3de9d5">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keyword">auto</span> str_view = <a class="code" href="structqjs_1_1js__traits.html">js_traits</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">&lt;</a>std<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">::</a>string_view<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">&gt;</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">::</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">unwrap</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">(</a>ctx<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">,</a> v<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">)</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> std::string{str_view.data(), str_view.size()};</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#ac5b51c364766cc6e173eb6fb473bca98">  241</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#ac5b51c364766cc6e173eb6fb473bca98">wrap</a>(JSContext * ctx, <span class="keyword">const</span> std::string&amp; str) <span class="keyword">noexcept</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">JS_NewStringLen</a><a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">(</a>ctx<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">,</a> str.data()<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">,</a> str.size()<a class="code" href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">)</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;};</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">/** Conversion from const char * */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html">  249</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keyword">const</span> <span class="keywordtype">char</span> *&gt;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ae1a13e887841edd9c73cc2ea8e72d7bb">  251</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ae1a13e887841edd9c73cc2ea8e72d7bb">wrap</a>(JSContext * ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> * str) <span class="keyword">noexcept</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#a0ee6a3654a6016393fac5e1c108f403a">JS_NewString</a><a class="code" href="quickjs_8c.html#a0ee6a3654a6016393fac5e1c108f403a">(</a>ctx<a class="code" href="quickjs_8c.html#a0ee6a3654a6016393fac5e1c108f403a">,</a> str<a class="code" href="quickjs_8c.html#a0ee6a3654a6016393fac5e1c108f403a">)</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ac03002f04b35482ae7ad9ac3a693ddbf">  255</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::js_string <a class="code" href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ac03002f04b35482ae7ad9ac3a693ddbf">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">&lt;</a>std<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">::</a>string_view<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">&gt;</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">::</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">unwrap</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">(</a>ctx<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">,</a> v<a class="code" href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">)</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;};</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html">  262</a></span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a> {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/** Helper function to convert and then free JSValue. */</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#a03413dce82c10c7e7680a1c64caae2c9">  266</a></span>&#160;T <a class="code" href="namespaceqjs_1_1detail.html#a03413dce82c10c7e7680a1c64caae2c9">unwrap_free</a>(JSContext * ctx, JSValue val)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(std::is_same_v&lt;T, <span class="keywordtype">void</span>&gt;)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">(</a>ctx<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">,</a> val<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">)</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;T&gt;::unwrap(ctx, val);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">try</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            T result = <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;T&gt;&gt;::unwrap(ctx, val);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">(</a>ctx<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">,</a> val<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">)</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">catch</span>(...)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">(</a>ctx<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">,</a> val<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">)</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">throw</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tuple, std::size_t... I&gt;</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#a0aa844300f88bcbc400ab4cf109a9fe4">  289</a></span>&#160;Tuple <a class="code" href="namespaceqjs_1_1detail.html#a0aa844300f88bcbc400ab4cf109a9fe4">unwrap_args_impl</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv, std::index_sequence&lt;I...&gt;)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> Tuple{<a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;std::tuple_element_t&lt;I, Tuple&gt;&gt;&gt;::unwrap(ctx, argv[I])...};</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">/** Helper function to convert an array of JSValues to a tuple.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> * @tparam Args C++ types of the argv array</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#a65d0ddd24470d7ce93d2352b5a5cdb33">  298</a></span>&#160;std::tuple&lt;std::decay_t&lt;Args&gt;...&gt; <a class="code" href="namespaceqjs_1_1detail.html#a65d0ddd24470d7ce93d2352b5a5cdb33">unwrap_args</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> unwrap_args_impl&lt;std::tuple&lt;std::decay_t&lt;Args&gt;...&gt;&gt;(ctx, argv, std::make_index_sequence&lt;<span class="keyword">sizeof</span>...(Args)&gt;());</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/** Helper function to call f with an array of JSValues.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * @tparam R return type of f</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> * @tparam Args argument types of f</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> * @tparam Callable type of f (inferred)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * @param ctx JSContext</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> * @param f callable object</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> * @param argv array of JSValue&#39;s</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * @return converted return value of f or JS_NULL if f returns void</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">typename</span>... Args, <span class="keyword">typename</span> Callable&gt;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#a2239084ae6320d2f421ec06b05b51382">  313</a></span>&#160;JSValue <a class="code" href="namespaceqjs_1_1detail.html#a2239084ae6320d2f421ec06b05b51382">wrap_call</a>(JSContext * ctx, Callable&amp;&amp; f, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">try</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(std::is_same_v&lt;R, <span class="keywordtype">void</span>&gt;)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            std::apply(std::forward&lt;Callable&gt;(f), unwrap_args&lt;Args...&gt;(ctx, argv));</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#af4a1e7a17bf31de1fcf48b5a70ed8dd8">JS_NULL</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;R&gt;&gt;::wrap(ctx,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                                    std::apply(std::forward&lt;Callable&gt;(f),</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                                               unwrap_args&lt;Args...&gt;(ctx, argv)));</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">catch</span>(<a class="code" href="classqjs_1_1exception.html">exception</a>)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/** Same as wrap_call, but pass this_value as first argument.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * @tparam FirstArg type of this_value</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">typename</span> FirstArg, <span class="keyword">typename</span>... Args, <span class="keyword">typename</span> Callable&gt;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#acf399d3f72253cdef48d48abfd97dc1d">  338</a></span>&#160;JSValue <a class="code" href="namespaceqjs_1_1detail.html#acf399d3f72253cdef48d48abfd97dc1d">wrap_this_call</a>(JSContext * ctx, Callable&amp;&amp; f, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">try</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(std::is_same_v&lt;R, <span class="keywordtype">void</span>&gt;)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            std::apply(std::forward&lt;Callable&gt;(f), std::tuple_cat(unwrap_args&lt;FirstArg&gt;(ctx, &amp;this_value),</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                                 unwrap_args&lt;Args...&gt;(ctx, argv)));</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#af4a1e7a17bf31de1fcf48b5a70ed8dd8">JS_NULL</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;R&gt;&gt;::wrap(ctx,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                    std::apply(std::forward&lt;Callable&gt;(f),</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                                               std::tuple_cat(</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                                       unwrap_args&lt;FirstArg&gt;(ctx, &amp;this_value),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                                       unwrap_args&lt;Args...&gt;(ctx, argv))));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">catch</span>(<a class="code" href="classqjs_1_1exception.html">exception</a>)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Tuple, std::size_t... I&gt;</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#a7c336da9a39cda78d9b67512812c5568">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceqjs_1_1detail.html#a7c336da9a39cda78d9b67512812c5568">wrap_args_impl</a>(JSContext * ctx, JSValue * argv, Tuple tuple, std::index_sequence&lt;I...&gt;)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    ((argv[I] = <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;std::tuple_element_t&lt;I, Tuple&gt;&gt;&gt;::wrap(ctx, std::get&lt;I&gt;(tuple))), ...);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/** Converts C++ args to JSValue array.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"> * @tparam Args argument types</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> * @param argv array of size at least sizeof...(Args)</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="namespaceqjs_1_1detail.html#ac10c8a8f94539ee1224b46b9007ab4af">  373</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceqjs_1_1detail.html#ac10c8a8f94539ee1224b46b9007ab4af">wrap_args</a>(JSContext * ctx, JSValue * argv, Args&amp;&amp; ... args)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;{</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    wrap_args_impl(ctx, argv, std::make_tuple(std::forward&lt;Args&gt;(args)...),</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                   std::make_index_sequence&lt;<span class="keyword">sizeof</span>...(Args)&gt;());</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;} <span class="comment">// namespace detail</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">/** A wrapper type for free and class member functions.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> * Pointer to function F is a template argument.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> * @tparam F either a pointer to free function or a pointer to class member function</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> * @tparam PassThis if true and F is a pointer to free function, passes Javascript &quot;this&quot; value as first argument:</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">auto</span> F, <span class="keywordtype">bool</span> PassThis = <span class="keyword">false</span> <span class="comment">/* pass this as the first argument */</span>&gt;</div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="structqjs_1_1fwrapper.html">  386</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">/// &quot;name&quot; property of the JS function object (not defined if nullptr)</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="structqjs_1_1fwrapper.html#a5ff19a2d124be6bbac4b5079d27ca0c6">  389</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="structqjs_1_1fwrapper.html#a5ff19a2d124be6bbac4b5079d27ca0c6">name</a> = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;};</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/** Conversion to JSValue for free function in fwrapper. */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">typename</span>... Args, R (* F)(Args...), <span class="keywordtype">bool</span> PassThis&gt;</div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_00_01PassThis_01_4_01_4.html">  394</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F, PassThis&gt;&gt;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_00_01PassThis_01_4_01_4.html#a8a5279bd3b11cdfc756aa5038fb59b47">  396</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_00_01PassThis_01_4_01_4.html#a8a5279bd3b11cdfc756aa5038fb59b47">wrap</a>(JSContext * ctx, <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F, PassThis&gt; fw) <span class="keyword">noexcept</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span> JS_NewCFunction(ctx, [](JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                       <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span> -&gt; JSValue {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(PassThis)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_this_call&lt;R, Args...&gt;(ctx, F, this_value, argv);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_call&lt;R, Args...&gt;(ctx, F, argv);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }, fw.name, <span class="keyword">sizeof</span>...(Args));</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;};</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">/** Conversion to JSValue for class member function in fwrapper. */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">class</span> T, <span class="keyword">typename</span>... Args, R (T::*F)(Args...)&gt;</div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html">  411</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt;&gt;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html#a70d968ba4279b45ace24740746d90eff">  413</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html#a70d968ba4279b45ace24740746d90eff">wrap</a>(JSContext * ctx, <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt; fw) <span class="keyword">noexcept</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">return</span> JS_NewCFunction(ctx, [](JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc,</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                       <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span> -&gt; JSValue {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_this_call&lt;R, std::shared_ptr&lt;T&gt;, Args...&gt;(ctx, F, this_value, argv);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }, fw.name, <span class="keyword">sizeof</span>...(Args));</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;};</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/** Conversion to JSValue for const class member function in fwrapper. */</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">class</span> T, <span class="keyword">typename</span>... Args, R (T::*F)(Args...) <span class="keyword">const</span>&gt;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt;&gt;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html#a70d968ba4279b45ace24740746d90eff">  427</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html#a70d968ba4279b45ace24740746d90eff">wrap</a>(JSContext * ctx, <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt; fw) <span class="keyword">noexcept</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span> JS_NewCFunction(ctx, [](JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                       <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span> -&gt; JSValue {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_this_call&lt;R, std::shared_ptr&lt;T&gt;, Args...&gt;(ctx, F, this_value, argv);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }, fw.name, <span class="keyword">sizeof</span>...(Args));</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;};</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">/** A wrapper type for constructor of type T with arguments Args.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"> * Compilation fails if no such constructor is defined.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"> * @tparam Args constructor arguments</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="structqjs_1_1ctor__wrapper.html">  442</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1ctor__wrapper.html">ctor_wrapper</a></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">static_assert</span>(std::is_constructible&lt;T, Args...&gt;::value, <span class="stringliteral">&quot;no such constructor!&quot;</span>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">/// &quot;name&quot; property of JS constructor object</span></div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="structqjs_1_1ctor__wrapper.html#ac23fa7c418fd0f0a1531365f6b78f679">  446</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="structqjs_1_1ctor__wrapper.html#ac23fa7c418fd0f0a1531365f6b78f679">name</a> = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;};</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">/** Conversion to JSValue for ctor_wrapper. */</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01ctor__wrapper_3_01T_00_01Args_8_8_8_01_4_01_4.html">  451</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="structqjs_1_1ctor__wrapper.html">ctor_wrapper</a>&lt;T, Args...&gt;&gt;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01ctor__wrapper_3_01T_00_01Args_8_8_8_01_4_01_4.html#ac3e4ebb181720971396c1bf6008a997b">  453</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01ctor__wrapper_3_01T_00_01Args_8_8_8_01_4_01_4.html#ac3e4ebb181720971396c1bf6008a997b">wrap</a>(JSContext * ctx, <a class="code" href="structqjs_1_1ctor__wrapper.html">ctor_wrapper</a>&lt;T, Args...&gt; cw) <span class="keyword">noexcept</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> JS_NewCFunction2(ctx, [](JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                        <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) <span class="keyword">noexcept</span> -&gt; JSValue {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            std::shared_ptr&lt;T&gt; ptr =  std::apply(std::make_shared&lt;T, Args...&gt;, <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::unwrap_args&lt;Args...&gt;(ctx, argv));</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::QJSClassId == 0) <span class="comment">// not registered</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::register_class(ctx, <span class="keyword">typeid</span>(T).name());</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="comment">//JS_ThrowTypeError(ctx, &quot;quickjspp: Class %s is not registered&quot;, typeid(T).name());</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="comment">//return JS_EXCEPTION;</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keyword">auto</span> proto = <a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">JS_GetPropertyStr</a><a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">(</a>ctx<a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">,</a> this_value<a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">,</a> <span class="stringliteral">&quot;prototype&quot;</span><a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">)</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a>proto<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="keywordflow">return</span> proto;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keyword">auto</span> jsobj = JS_NewObjectProtoClass(ctx, proto, <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::QJSClassId);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">(</a>ctx<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">,</a> proto<a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">)</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">if</span> (JS_IsException(jsobj))</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="comment">//auto pptr = new std::shared_ptr&lt;T&gt;(std::move(ptr));</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keyword">auto</span> alloc = <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;std::shared_ptr&lt;T&gt;&gt;{ctx};</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keyword">using</span> atraits = std::allocator_traits&lt;<span class="keyword">decltype</span>(alloc)&gt;;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keyword">auto</span> pptr = atraits::allocate(alloc, 1);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            atraits::construct(alloc, pptr, std::move(ptr));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            JS_SetOpaque(jsobj, pptr);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="comment">// return detail::wrap_call&lt;std::shared_ptr&lt;T&gt;, Args...&gt;(ctx, std::make_shared&lt;T, Args...&gt;, argv);</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }, cw.name, <span class="keyword">sizeof</span>...(Args), <a class="code" href="quickjs_8h.html#a191efd2d7aab4362bf3c9e2049402e72ad7162837bf33ab604fb2cac5f3892ca7">JS_CFUNC_constructor</a>, 0);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;};</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">/** Conversions for std::shared_ptr&lt;T&gt;.</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"> * T should be registered to a context before conversions.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"> * @tparam T class type</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html">  495</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;{</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">/// Registered class id in QuickJS.</span></div><div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">  498</a></span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="quickjs_8h.html#a451d6a9cf9c7412aa33211fd887c7368">JSClassID</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a> = 0;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/** Register class in QuickJS context.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">     * @param ctx context</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">     * @param name class name</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">     * @param proto class prototype or JS_NULL</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">     * @throws exception</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">  507</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">register_class</a>(JSContext * ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> * name, JSValue proto = <a class="code" href="quickjs_8h.html#af4a1e7a17bf31de1fcf48b5a70ed8dd8">JS_NULL</a>)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a> == 0)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">JS_NewClassID</a><a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">(</a>&amp;<a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">)</a>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keyword">auto</span> rt = <a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a><a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">(</a>ctx<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">)</a>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">JS_IsRegisteredClass</a><a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">(</a>rt<a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">)</a>)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            JSClassDef def{</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    name,</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <span class="comment">// destructor</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    [](JSRuntime * rt, JSValue obj) <span class="keyword">noexcept</span> {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        <span class="keyword">auto</span> pptr = <span class="keyword">reinterpret_cast</span>&lt;std::shared_ptr&lt;T&gt; *&gt;(<a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">JS_GetOpaque</a><a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">(</a>obj<a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">)</a>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        assert(pptr);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        <span class="comment">//delete pptr;</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        <span class="keyword">auto</span> alloc = <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;std::shared_ptr&lt;T&gt;&gt;{rt};</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="keyword">using</span> atraits = std::allocator_traits&lt;<span class="keyword">decltype</span>(alloc)&gt;;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        atraits::destroy(alloc, pptr);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        atraits::deallocate(alloc, pptr, 1);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            };</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordtype">int</span> e = <a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">JS_NewClass</a><a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">(</a>rt<a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">,</a> &amp;def<a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">)</a>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">if</span>(e &lt; 0)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <a class="code" href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">JS_ThrowInternalError</a><a class="code" href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">(</a>ctx<a class="code" href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">,</a> <span class="stringliteral">&quot;Cant register class %s&quot;</span><a class="code" href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">,</a> name<a class="code" href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">)</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">JS_SetClassProto</a><a class="code" href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">(</a>ctx<a class="code" href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">,</a> proto<a class="code" href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">)</a>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">/** Create a JSValue from std::shared_ptr&lt;T&gt;.</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">     * Creates an object with class if #QJSClassId and sets its opaque pointer to a new copy of #ptr.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a046f811ae16e0cb24170a8425f3e8780">  542</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a046f811ae16e0cb24170a8425f3e8780">wrap</a>(JSContext * ctx, std::shared_ptr&lt;T&gt; ptr)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a> == 0) <span class="comment">// not registered</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">register_class</a><a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">(</a>ctx<a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">,</a> <span class="keyword">typeid</span>(T).name()<a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">)</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">//JS_ThrowTypeError(ctx, &quot;quickjspp: Class %s is not registered&quot;, typeid(T).name());</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">//return JS_EXCEPTION;</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">auto</span> jsobj = <a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">JS_NewObjectClass</a><a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">(</a>ctx<a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">)</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a>jsobj<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="comment">//auto pptr = new std::shared_ptr&lt;T&gt;(std::move(ptr));</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keyword">auto</span> alloc = <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;std::shared_ptr&lt;T&gt;&gt;{ctx};</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keyword">using</span> atraits = std::allocator_traits&lt;<span class="keyword">decltype</span>(alloc)&gt;;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keyword">auto</span> pptr = atraits::allocate(alloc, 1);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        atraits::construct(alloc, pptr, std::move(ptr));</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        JS_SetOpaque(jsobj, pptr);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">/// @throws exception if #v doesn&#39;t have the correct class id</span></div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a34eea271d3cd85ddae26e5c33b400070">  566</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::shared_ptr&lt;T&gt;&amp; <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a34eea271d3cd85ddae26e5c33b400070">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keyword">auto</span> ptr = <span class="keyword">reinterpret_cast</span>&lt;std::shared_ptr&lt;T&gt; *&gt;(<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">JS_GetOpaque2</a><a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">(</a>ctx<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">,</a> v<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">,</a> <a class="code" href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">QJSClassId</a><a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">)</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">if</span>(!ptr)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">return</span> *ptr;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;};</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">// T * - non-owning pointer</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00577"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01T_01_5_01_4.html">  577</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;T *&gt;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;{</div><div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a1dbb626be00a1b77338c6bc7235240ee">  579</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a1dbb626be00a1b77338c6bc7235240ee">wrap</a>(JSContext * ctx, T * ptr)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::QJSClassId == 0) <span class="comment">// not registered</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::register_class(ctx, <span class="keyword">typeid</span>(T).name());</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="comment">//JS_ThrowTypeError(ctx, &quot;quickjspp: Class %s is not registered&quot;, typeid(T).name());</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="comment">//return JS_EXCEPTION;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keyword">auto</span> jsobj = JS_NewObjectClass(ctx, <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::QJSClassId);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span>(JS_IsException(jsobj))</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">//auto pptr = new std::shared_ptr&lt;T&gt;(ptr, [](T *){});</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keyword">auto</span> alloc = <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;std::shared_ptr&lt;T&gt;&gt;{ctx};</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keyword">using</span> atraits = std::allocator_traits&lt;<span class="keyword">decltype</span>(alloc)&gt;;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keyword">auto</span> pptr = atraits::allocate(alloc, 1);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        atraits::construct(alloc, pptr, ptr, [](T *) {}); <span class="comment">// shared_ptr with empty deleter</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        JS_SetOpaque(jsobj, pptr);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">return</span> jsobj;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a56209aec4204470bd9528be7027da5a0">  602</a></span>&#160;    <span class="keyword">static</span> T * <a class="code" href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a56209aec4204470bd9528be7027da5a0">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keyword">auto</span> ptr = <span class="keyword">reinterpret_cast</span>&lt;std::shared_ptr&lt;T&gt; *&gt;(JS_GetOpaque2(ctx, v,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                                        <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::QJSClassId));</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span>(!ptr)</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">return</span> ptr-&gt;get();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;};</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a> {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">/** A faster std::function-like object with type erasure.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> * Used to convert any callable objects (including lambdas) to JSValue.</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1function.html">  616</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1detail_1_1function.html">function</a></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    JSValue</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1function.html#ac7c8bb2865f924c4d60b30a607551761">  619</a></span>&#160;    (* invoker)(<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> * self, JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">  621</a></span>&#160;    <span class="keywordtype">void</span> (* <a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">destroyer</a>)(<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> * self) = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">  623</a></span>&#160;    <span class="keyword">alignas</span>(<a class="code" href="structqjs_1_1detail_1_1function.html">std</a>::<a class="code" href="structqjs_1_1detail_1_1function.html">max_align_t</a>) <span class="keywordtype">char</span> <a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">functor</a>[];</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Functor&gt;</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1function.html#a416a24c42e5b38a43f957096822b1949">  626</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="structqjs_1_1detail_1_1function.html">function</a> * <a class="code" href="structqjs_1_1detail_1_1function.html#a416a24c42e5b38a43f957096822b1949">create</a>(JSRuntime * rt, Functor&amp;&amp; f)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keyword">auto</span> fptr = <span class="keyword">reinterpret_cast</span>&lt;<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> *&gt;(<a class="code" href="quickjs_8c.html#a4b710876403548c1ad3edc7a7719c559">js_malloc_rt</a><a class="code" href="quickjs_8c.html#a4b710876403548c1ad3edc7a7719c559">(</a>rt<a class="code" href="quickjs_8c.html#a4b710876403548c1ad3edc7a7719c559">,</a> <span class="keyword">sizeof</span>(<a class="code" href="structqjs_1_1detail_1_1function.html">function</a>) + <span class="keyword">sizeof</span>(Functor)<a class="code" href="quickjs_8c.html#a4b710876403548c1ad3edc7a7719c559">)</a>);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span>(!fptr)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">throw</span> std::bad_alloc{};</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keyword">new</span>(fptr) <a class="code" href="structqjs_1_1detail_1_1function.html">function</a>;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">auto</span> functorptr = <span class="keyword">reinterpret_cast</span>&lt;Functor *&gt;(fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">functor</a>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keyword">new</span>(functorptr) Functor(std::forward&lt;Functor&gt;(f));</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">destroyer</a> = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(!std::is_trivially_destructible_v&lt;Functor&gt;)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">destroyer</a> = [](<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> * fptr) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="keyword">auto</span> functorptr = <span class="keyword">reinterpret_cast</span>&lt;Functor *&gt;(fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">functor</a>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                functorptr-&gt;~Functor();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            };</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">return</span> fptr;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;};</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keyword">static_assert</span>(std::is_trivially_destructible_v&lt;<a class="code" href="structqjs_1_1detail_1_1function.html">function</a>&gt;);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html">  650</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1function.html">function</a>&gt;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div><div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">  652</a></span>&#160;    <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="quickjs_8h.html#a451d6a9cf9c7412aa33211fd887c7368">JSClassID</a> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a> = 0;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// TODO: replace ctx with rt</span></div><div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">  655</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">register_class</a>(JSContext * ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a> == 0)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">JS_NewClassID</a><a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">(</a>&amp;<a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">)</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keyword">auto</span> rt = <a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a><a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">(</a>ctx<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">)</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">JS_IsRegisteredClass</a><a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">(</a>rt<a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">,</a> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">)</a>)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        JSClassDef def{</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                name,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="comment">// destructor</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                [](JSRuntime * rt, JSValue obj) <span class="keyword">noexcept</span> {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    <span class="keyword">auto</span> fptr = <span class="keyword">reinterpret_cast</span>&lt;<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> *&gt;(<a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">JS_GetOpaque</a><a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">(</a>obj<a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">,</a> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">)</a>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    assert(fptr);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    <span class="keywordflow">if</span>(fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">destroyer</a>)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                        fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">destroyer</a><a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">(</a>fptr<a class="code" href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">)</a>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <a class="code" href="quickjs_8c.html#a69e19dda8a93d613203e0baa06f0ed8d">js_free_rt</a><a class="code" href="quickjs_8c.html#a69e19dda8a93d613203e0baa06f0ed8d">(</a>rt<a class="code" href="quickjs_8c.html#a69e19dda8a93d613203e0baa06f0ed8d">,</a> fptr<a class="code" href="quickjs_8c.html#a69e19dda8a93d613203e0baa06f0ed8d">)</a>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                },</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordtype">nullptr</span>, <span class="comment">// mark</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="comment">// call</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                [](JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> func_obj, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_val, <span class="keywordtype">int</span> argc,</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                   <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv, <span class="keywordtype">int</span> flags) -&gt; JSValue {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="keyword">auto</span> ptr = <span class="keyword">reinterpret_cast</span>&lt;<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> *&gt;(<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">JS_GetOpaque2</a><a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">(</a>ctx<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">,</a> func_obj<a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">,</a> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">)</a>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="keywordflow">if</span>(!ptr)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="keywordflow">return</span> ptr-&gt;invoker(ptr, ctx, this_val, argc, argv);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        };</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordtype">int</span> e = <a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">JS_NewClass</a><a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">(</a>rt<a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">,</a> <a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">,</a> &amp;def<a class="code" href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">)</a>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">if</span>(e &lt; 0)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error{<span class="stringliteral">&quot;Cannot register C++ function class&quot;</span>};</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;};</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">/** Traits for accessing object properties.</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> * @tparam Key property key type (uint32 and strings are supported)</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Key&gt;</div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits.html">  695</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__property__traits.html">js_property_traits</a></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;{</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1js__property__traits.html#aab2e574fd3e63cbde699e6df9218a66c">set_property</a>(JSContext * ctx, JSValue this_obj, Key key, JSValue value);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__property__traits.html#a728896ee56f225c3babba3fa8f6b418d">get_property</a>(JSContext * ctx, JSValue this_obj, Key key);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;};</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html">  702</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__property__traits.html">js_property_traits</a>&lt;<span class="keyword">const</span> <span class="keywordtype">char</span> *&gt;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;{</div><div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#ad7131d2b5de0ffc36fba2524b6d88f11">  704</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#ad7131d2b5de0ffc36fba2524b6d88f11">set_property</a>(JSContext * ctx, JSValue this_obj, <span class="keyword">const</span> <span class="keywordtype">char</span> * name, JSValue value)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordtype">int</span> err = <a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">JS_SetPropertyStr</a><a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">(</a>ctx<a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">,</a> this_obj<a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">,</a> name<a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">,</a> value<a class="code" href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">)</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span>(err &lt; 0)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#a0a01071b0c80a16dbd7d0fa538534116">  711</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#a0a01071b0c80a16dbd7d0fa538534116">get_property</a>(JSContext * ctx, JSValue this_obj, <span class="keyword">const</span> <span class="keywordtype">char</span> * name) <span class="keyword">noexcept</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">JS_GetPropertyStr</a><a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">(</a>ctx<a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">,</a> this_obj<a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">,</a> name<a class="code" href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">)</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;};</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html">  718</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__property__traits.html">js_property_traits</a>&lt;uint32_t&gt;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div><div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#a80956064f81774837d511e8321056418">  720</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#a80956064f81774837d511e8321056418">set_property</a>(JSContext * ctx, JSValue this_obj, uint32_t idx, JSValue value)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordtype">int</span> err = <a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">JS_SetPropertyUint32</a><a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">(</a>ctx<a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">,</a> this_obj<a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">,</a> idx<a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">,</a> value<a class="code" href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">)</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span>(err &lt; 0)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#af19da02fec28059477a39b16c531a97c">  727</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#af19da02fec28059477a39b16c531a97c">get_property</a>(JSContext * ctx, JSValue this_obj, uint32_t idx) <span class="keyword">noexcept</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">JS_GetPropertyUint32</a><a class="code" href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">(</a>ctx<a class="code" href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">,</a> this_obj<a class="code" href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">,</a> idx<a class="code" href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">)</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;};</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keyword">class</span> <a class="code" href="classqjs_1_1Value.html">Value</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a> {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Key&gt;</div><div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html">  737</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1detail_1_1property__proxy.html">property_proxy</a></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;{</div><div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">  739</a></span>&#160;    JSContext * <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">ctx</a>;</div><div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#a256f35584ca0565461b092c78d2206dd">  740</a></span>&#160;    JSValue <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a256f35584ca0565461b092c78d2206dd">this_obj</a>;</div><div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#a1ecfe9898fdc564669510d3f2fe7dbce">  741</a></span>&#160;    Key <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a1ecfe9898fdc564669510d3f2fe7dbce">key</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">/** Conversion helper function */</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#afa425b198f80c0e81b8415b3d898539a">  745</a></span>&#160;    T <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#afa425b198f80c0e81b8415b3d898539a">as</a>() <span class="keyword">const</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">return</span> unwrap_free&lt;T&gt;(<a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">ctx</a>, <a class="code" href="structqjs_1_1js__property__traits.html">js_property_traits</a>&lt;Key&gt;::get_property(<a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">ctx</a>, <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a256f35584ca0565461b092c78d2206dd">this_obj</a>, <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a1ecfe9898fdc564669510d3f2fe7dbce">key</a>));</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">/** Explicit conversion operator (to any type) */</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#ae3977f7f157a8a60242089cfd8578d54">  752</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#ae3977f7f157a8a60242089cfd8578d54">operator</a> T() <span class="keyword">const</span> { <span class="keywordflow">return</span> as&lt;T&gt;(); }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">/** Implicit converion to qjs::Value */</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#af5ab01d0154d84c8f16e93563a37db16">operator</a> <a class="code" href="classqjs_1_1Value.html">Value</a>() <span class="keyword">const</span>; <span class="comment">// defined later due to Value being incomplete type</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Value&gt;</div><div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#a01f1f28aee483207a570f6f6e2704ebc">  758</a></span>&#160;    <a class="code" href="structqjs_1_1detail_1_1property__proxy.html">property_proxy</a>&amp; <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a01f1f28aee483207a570f6f6e2704ebc">operator</a> =(Value value)</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <a class="code" href="structqjs_1_1js__property__traits.html">js_property_traits</a>&lt;Key&gt;::set_property(<a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">ctx</a>, <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a256f35584ca0565461b092c78d2206dd">this_obj</a>, <a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a1ecfe9898fdc564669510d3f2fe7dbce">key</a>,</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                              <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;Value&gt;::wrap(<a class="code" href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">ctx</a>, std::move(value)));</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;};</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">// class member variable getter/setter</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">auto</span> M&gt;</div><div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1get__set.html">  769</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1detail_1_1get__set.html">get_set</a> {};</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">typename</span> R, R T::*M&gt;</div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html">  772</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1detail_1_1get__set.html">get_set</a>&lt;M&gt;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#a3a42d1ecd2cf5a0b97cb13964b249476">  774</a></span>&#160;    <span class="keyword">using</span> is_const = std::is_const&lt;R&gt;;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ad78011ef0001019a971c3b4e00db756f">  776</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> R&amp; <a class="code" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ad78011ef0001019a971c3b4e00db756f">get</a>(<span class="keyword">const</span> std::shared_ptr&lt;T&gt;&amp; ptr)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">return</span> *ptr.*M;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ae3c3f195e157f6114e3e0fb66e50d2b9">  781</a></span>&#160;    <span class="keyword">static</span> R&amp; <a class="code" href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ae3c3f195e157f6114e3e0fb66e50d2b9">set</a>(<span class="keyword">const</span> std::shared_ptr&lt;T&gt;&amp; ptr, R value)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">return</span> *ptr.*M = std::move(value);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;};</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;} <span class="comment">// namespace detail</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">/** JSValue with RAAI semantics.</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"> * A wrapper over (JSValue v, JSContext * ctx).</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"> * Calls JS_FreeValue(ctx, v) on destruction. Can be copied and moved.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"> * A JSValue can be released by either JSValue x = std::move(value); or JSValue x = value.release(), then the Value becomes invalid and FreeValue won&#39;t be called</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"> * Can be converted to C++ type, for example: auto string = value.as&lt;std::string&gt;(); qjs::exception would be thrown on error</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> * Properties can be accessed (read/write): value[&quot;property1&quot;] = 1; value[2] = &quot;2&quot;;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html">  797</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classqjs_1_1Value.html">Value</a></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;{</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">  800</a></span>&#160;    JSValue <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>;</div><div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">  801</a></span>&#160;    JSContext * <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">/** Use context.newValue(val) instead */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">  806</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">Value</a>(JSContext * ctx, T&amp;&amp; val) : <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>(ctx)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a> = <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;T&gt;&gt;::wrap(ctx, std::forward&lt;T&gt;(val));</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a37173af959da7e4188e228aa95f8f90f">  813</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#a37173af959da7e4188e228aa95f8f90f">Value</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; rhs)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> = rhs<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a> = <a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">,</a> rhs<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">)</a>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a5ee42d3287ecb77644036362f9115e16">  819</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#a5ee42d3287ecb77644036362f9115e16">Value</a>(<a class="code" href="classqjs_1_1Value.html">Value</a>&amp;&amp; rhs)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        std::swap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, rhs<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a> = rhs<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#aaf15ddf408ae1f1d6d6c320f78986d12">  825</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; <a class="code" href="classqjs_1_1Value.html#aaf15ddf408ae1f1d6d6c320f78986d12">operator</a>=(<a class="code" href="classqjs_1_1Value.html">Value</a> rhs)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        std::swap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, rhs<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        std::swap(<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>, rhs<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#ab8ec63e4233d09332fb114fad78db380">  832</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classqjs_1_1Value.html#ab8ec63e4233d09332fb114fad78db380">operator</a>==(<a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> other) <span class="keyword">const</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#acfa4fd7848997fa4af3ee04a2f63aac7">JS_VALUE_GET_TAG</a>(<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>) == <a class="code" href="quickjs_8h.html#acfa4fd7848997fa4af3ee04a2f63aac7">JS_VALUE_GET_TAG</a>(other) &amp;&amp; <a class="code" href="quickjs_8h.html#ac9ac6d792cab919178eb83a57bc26683">JS_VALUE_GET_PTR</a>(<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>) == <a class="code" href="quickjs_8h.html#ac9ac6d792cab919178eb83a57bc26683">JS_VALUE_GET_PTR</a>(other);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a329cdcdab71bdeec91a081d013b01f4e">  837</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classqjs_1_1Value.html#a329cdcdab71bdeec91a081d013b01f4e">operator</a>!=(<a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> other) <span class="keyword">const</span> { <span class="keywordflow">return</span> !((*<span class="keyword">this</span>) <a class="code" href="classqjs_1_1Value.html#ab8ec63e4233d09332fb114fad78db380">==</a> other); }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">/** Returns true if 2 values are the same (equality for arithmetic types or point to the same object) */</span></div><div class="line"><a name="l00841"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a99e7e88f8be813095ae52fa47da333b0">  841</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classqjs_1_1Value.html#a99e7e88f8be813095ae52fa47da333b0">operator</a>==(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; rhs) <span class="keyword">const</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> == rhs<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> &amp;&amp; (*<span class="keyword">this</span> <a class="code" href="classqjs_1_1Value.html#ab8ec63e4233d09332fb114fad78db380">==</a> rhs<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a4e7fefdc18a3dc4f54b6b767433d3198">  846</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classqjs_1_1Value.html#a4e7fefdc18a3dc4f54b6b767433d3198">operator</a>!=(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; rhs) <span class="keyword">const</span> { <span class="keywordflow">return</span> !((*<span class="keyword">this</span>) <a class="code" href="classqjs_1_1Value.html#a99e7e88f8be813095ae52fa47da333b0">==</a> rhs); }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#acffffa8a01df1832830c23631bdfcd6c">  849</a></span>&#160;    ~<a class="code" href="classqjs_1_1Value.html#acffffa8a01df1832830c23631bdfcd6c">Value</a>()</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>) <a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">,</a> <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">)</a>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a57d738d3c1035c1cccbec16676fa59db">  854</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classqjs_1_1Value.html#a57d738d3c1035c1cccbec16676fa59db">isError</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="quickjs_8c.html#afc9f16af1ddbee548aa05ae2d28dcd16">JS_IsError</a><a class="code" href="quickjs_8c.html#afc9f16af1ddbee548aa05ae2d28dcd16">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8c.html#afc9f16af1ddbee548aa05ae2d28dcd16">,</a> <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8c.html#afc9f16af1ddbee548aa05ae2d28dcd16">)</a>; }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">/** Conversion helper function. Both value.as&lt;T&gt;() and static_cast&lt;T&gt;(value) are supported */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a8d0d3600bdc9045267bfd6e8823e87c8">  858</a></span>&#160;    T <a class="code" href="classqjs_1_1Value.html#a8d0d3600bdc9045267bfd6e8823e87c8">as</a>() <span class="keyword">const</span> { <span class="keywordflow">return</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::decay_t&lt;T&gt;&gt;::unwrap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>); }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">/** Explicit conversion to any type */</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00862"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#aa0eaa45d4cb0f1d7d7c42bccaef35ef6">  862</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classqjs_1_1Value.html#aa0eaa45d4cb0f1d7d7c42bccaef35ef6">operator</a> T() <span class="keyword">const</span> { <span class="keywordflow">return</span> as&lt;T&gt;(); }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">  864</a></span>&#160;    JSValue <a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">release</a>() <span class="comment">// dont call freevalue</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> = <span class="keywordtype">nullptr</span>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">/** Implicit conversion to JSValue (rvalue only). Example: JSValue v = std::move(value); */</span></div><div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#ad04b949f09968e4677fcfc1141b4b180">  871</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#ad04b949f09968e4677fcfc1141b4b180">operator</a> JSValue() &amp;&amp; { <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">release</a><a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">(</a><a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">)</a>; }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">/** Access JS properties. Returns proxy type which is implicitly convertible to qjs::Value */</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Key&gt;</div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">  876</a></span>&#160;    <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1property__proxy.html">property_proxy</a>&lt;Key&gt; <a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">operator</a> [](Key key)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">return</span> {<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>, std::move(key)};</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// add(&quot;f&quot;, []() {...});</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Function&gt;</div><div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#a4abc02a924e2c5085c09c60417243aec">  884</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; <a class="code" href="classqjs_1_1Value.html#a4abc02a924e2c5085c09c60417243aec">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, Function&amp;&amp; f)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        (*<span class="keyword">this</span>)<a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">[</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">name</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">]</a> = <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keyword">decltype</span>(std::function{std::forward&lt;Function&gt;(f)})&gt;::wrap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>,</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                                                                            std::forward&lt;Function&gt;(f));</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// add&lt;&amp;f&gt;(&quot;f&quot;);</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// add&lt;&amp;T::f&gt;(&quot;f&quot;);</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">auto</span> F&gt;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    std::enable_if_t&lt;!std::is_member_object_pointer_v&lt;<span class="keyword">decltype</span>(F)&gt;, <a class="code" href="classqjs_1_1Value.html">Value</a>&amp;&gt;</div><div class="line"><a name="l00895"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#af89ba06f7b83190d4fdb775c5964dcf9">  895</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#af89ba06f7b83190d4fdb775c5964dcf9">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        (*<span class="keyword">this</span>)<a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">[</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">name</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">]</a> = <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt;{name};</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// add&lt;&amp;T::member&gt;(&quot;member&quot;);</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">auto</span> M&gt;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    std::enable_if_t&lt;std::is_member_object_pointer_v&lt;<span class="keyword">decltype</span>(M)&gt;, <a class="code" href="classqjs_1_1Value.html">Value</a>&amp;&gt;</div><div class="line"><a name="l00904"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#abd7b1697b6736617ad2d571adea7b68f">  904</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html#abd7b1697b6736617ad2d571adea7b68f">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keyword">auto</span> prop = <a class="code" href="quickjs_8c.html#aa2ef5af1544a3012f91a80c98c326b8f">JS_NewAtom</a><a class="code" href="quickjs_8c.html#aa2ef5af1544a3012f91a80c98c326b8f">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8c.html#aa2ef5af1544a3012f91a80c98c326b8f">,</a> name<a class="code" href="quickjs_8c.html#aa2ef5af1544a3012f91a80c98c326b8f">)</a>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keyword">using</span> fgetter = <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1get__set.html">get_set</a>&lt;M&gt;::get, <span class="keyword">true</span>&gt;;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1get__set.html">get_set</a>&lt;M&gt;::is_const::value)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            ret = JS_DefinePropertyGetSet(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>, prop,</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                          <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;fgetter&gt;::wrap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, fgetter{name}),</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                          <a class="code" href="quickjs_8h.html#ac363230cf3ec220f5788a1f85976f205">JS_UNDEFINED</a>,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                          <a class="code" href="quickjs_8h.html#ac6d59bf69724330a254181bca0519dac">JS_PROP_CONFIGURABLE</a> | <a class="code" href="quickjs_8h.html#a589fb368a95830fddfde74257423513e">JS_PROP_ENUMERABLE</a></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            );</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keyword">using</span> fsetter = <a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;<a class="code" href="namespaceqjs_1_1detail.html">detail</a>::<a class="code" href="structqjs_1_1detail_1_1get__set.html">get_set</a>&lt;M&gt;::set, <span class="keyword">true</span>&gt;;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            ret = JS_DefinePropertyGetSet(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>, prop,</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                          <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;fgetter&gt;::wrap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, fgetter{name}),</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                          <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;fsetter&gt;::wrap(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, fsetter{name}),</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                          <a class="code" href="quickjs_8h.html#ac6d59bf69724330a254181bca0519dac">JS_PROP_CONFIGURABLE</a> | <a class="code" href="quickjs_8h.html#ab56f74e66d354104a7af2ecb922960e4">JS_PROP_WRITABLE</a> | <a class="code" href="quickjs_8h.html#a589fb368a95830fddfde74257423513e">JS_PROP_ENUMERABLE</a></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            );</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="quickjs_8c.html#ab7fc45a99935a1c0ba50b0216d9401a9">JS_FreeAtom</a><a class="code" href="quickjs_8c.html#ab7fc45a99935a1c0ba50b0216d9401a9">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8c.html#ab7fc45a99935a1c0ba50b0216d9401a9">,</a> prop<a class="code" href="quickjs_8c.html#ab7fc45a99935a1c0ba50b0216d9401a9">)</a>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">if</span>(ret &lt; 0)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="classqjs_1_1Value.html#aa57193f349f84eb585eebb67c6334be1">  931</a></span>&#160;    std::string <a class="code" href="classqjs_1_1Value.html#aa57193f349f84eb585eebb67c6334be1">toJSON</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; replacer = <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><span class="keywordtype">nullptr</span><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8h.html#ac363230cf3ec220f5788a1f85976f205">JS_UNDEFINED</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>, <span class="keyword">const</span> <a class="code" href="classqjs_1_1Value.html">Value</a>&amp; space = <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><span class="keywordtype">nullptr</span><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8h.html#ac363230cf3ec220f5788a1f85976f205">JS_UNDEFINED</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        assert(<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        assert(!replacer<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> || <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> == replacer<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        assert(!space<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> || <a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> == space<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        JSValue json = <a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">JS_JSONStringify</a><a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">(</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">,</a> <a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">,</a> replacer<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">,</a> space<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">)</a>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordflow">return</span> (std::string)<a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> json<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;};</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">/** Thin wrapper over JSRuntime * rt</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"> * Calls JS_FreeRuntime on destruction. noncopyable.</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="classqjs_1_1Runtime.html">  945</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classqjs_1_1Runtime.html">Runtime</a></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;{</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00948"></a><span class="lineno"><a class="line" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">  948</a></span>&#160;    JSRuntime * <a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">rt</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno"><a class="line" href="classqjs_1_1Runtime.html#a0860a1339ff567f9f603c7bed4d670f9">  950</a></span>&#160;    <a class="code" href="classqjs_1_1Runtime.html#a0860a1339ff567f9f603c7bed4d670f9">Runtime</a>()</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">rt</a> = <a class="code" href="quickjs_8c.html#afc1ca27a266094085ebb43e2eea0dda2">JS_NewRuntime</a><a class="code" href="quickjs_8c.html#afc1ca27a266094085ebb43e2eea0dda2">(</a><a class="code" href="quickjs_8c.html#afc1ca27a266094085ebb43e2eea0dda2">)</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">rt</a>)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error{<span class="stringliteral">&quot;qjs: Cannot create runtime&quot;</span>};</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// noncopyable</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="classqjs_1_1Runtime.html#a4ed2f53478c9503702827ed7b3503e96">Runtime</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Runtime.html">Runtime</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="classqjs_1_1Runtime.html#a44c5deb57118d67e36f2e002f393ff43">  960</a></span>&#160;    ~<a class="code" href="classqjs_1_1Runtime.html#a44c5deb57118d67e36f2e002f393ff43">Runtime</a>()</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <a class="code" href="quickjs_8c.html#ad80a65b72c3a346d8a0047858a5f0b13">JS_FreeRuntime</a><a class="code" href="quickjs_8c.html#ad80a65b72c3a346d8a0047858a5f0b13">(</a><a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">rt</a><a class="code" href="quickjs_8c.html#ad80a65b72c3a346d8a0047858a5f0b13">)</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;};</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">/** Wrapper over JSContext * ctx</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"> * Calls JS_SetContextOpaque(ctx, this); on construction and JS_FreeContext on destruction</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html">  969</a></span>&#160;<span class="keyword">class</span> <a class="code" href="classqjs_1_1Context.html">Context</a></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;{</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00972"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">  972</a></span>&#160;    JSContext * <a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">/** Module wrapper</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">     * Workaround for lack of opaque pointer for module load function by keeping a list of modules in qjs::Context.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00977"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html">  977</a></span>&#160;    <span class="keyword">class</span> <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    {</div><div class="line"><a name="l00979"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#ac26c806e60ca4a0547680edb68f6e39b">  979</a></span>&#160;        <span class="keyword">friend</span> <span class="keyword">class</span> <a class="code" href="classqjs_1_1Context.html">Context</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">  981</a></span>&#160;        JSModuleDef * <a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a>;</div><div class="line"><a name="l00982"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">  982</a></span>&#160;        JSContext * <a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a>;</div><div class="line"><a name="l00983"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#add0335ad35de9949210e4a5f3fa0751a">  983</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classqjs_1_1Context_1_1Module.html#add0335ad35de9949210e4a5f3fa0751a">name</a>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#af3916477736b887af6e1e348b5807bc8">  985</a></span>&#160;        <span class="keyword">using</span> nvp = std::pair&lt;<span class="keyword">const</span> <span class="keywordtype">char</span> *, <a class="code" href="classqjs_1_1Value.html">Value</a>&gt;;</div><div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">  986</a></span>&#160;        std::vector&lt;nvp, <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;nvp&gt;&gt; <a class="code" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">exports</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a3b16e4ca57ab1de004a35ae1930b40d2">  988</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html#a3b16e4ca57ab1de004a35ae1930b40d2">Module</a>(JSContext * ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> * name) : <a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a>(ctx), <a class="code" href="classqjs_1_1Context_1_1Module.html#add0335ad35de9949210e4a5f3fa0751a">name</a>(name), <a class="code" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">exports</a>(<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a><a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">(</a>ctx<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">)</a>)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a> = <a class="code" href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">JS_NewCModule</a><a class="code" href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">(</a>ctx<a class="code" href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">,</a> name<a class="code" href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">,</a> [](JSContext * ctx, JSModuleDef * m) <span class="keyword">noexcept</span> {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="keyword">auto</span>&amp; context = <a class="code" href="classqjs_1_1Context.html">Context</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">::</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">get</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">(</a>ctx<a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">)</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <span class="keyword">auto</span> it = std::find_if(context<a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">.</a><a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.begin(), context<a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">.</a><a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.end(),</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                       [m](<span class="keyword">const</span> <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; module) { <span class="keywordflow">return</span> module<a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">.</a><a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a> == m; });</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <span class="keywordflow">if</span>(it == context<a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">.</a><a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.end())</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : it-&gt;<a class="code" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">exports</a>)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">JS_SetModuleExport</a><a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">(</a>ctx<a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">,</a> m<a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">,</a> e.first<a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">,</a> <a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">(</a>ctx<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">,</a> e.second<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">)</a><a class="code" href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">)</a> != 0)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            }<a class="code" href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">)</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a>)</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#aa51896e065a04689c9dbe80a282805bb"> 1007</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module.html#aa51896e065a04689c9dbe80a282805bb">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, JSValue value)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">exports</a>.push_back({name, <a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> value<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>});</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">JS_AddModuleExport</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">(</a><a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">,</a> <a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">,</a> name<a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">)</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a0baf8fad2f079e722cb71afbd55f2ce9"> 1014</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module.html#a0baf8fad2f079e722cb71afbd55f2ce9">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, <a class="code" href="classqjs_1_1Value.html">Value</a> value)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            assert(value<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a> == <a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a>);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">exports</a>.push_back({name, std::move(value)});</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">JS_AddModuleExport</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">(</a><a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">,</a> <a class="code" href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">m</a><a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">,</a> name<a class="code" href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">)</a>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a21c2f81a213eb9d0c52d58d09bbf61a3"> 1023</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module.html#a21c2f81a213eb9d0c52d58d09bbf61a3">add</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, T value)</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        {</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordflow">return</span> add(name, <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;T&gt;::wrap(<a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a>, std::move(value)));</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html#a615b7f44778ba84c409e73e66c93d7d4">Module</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html#a0011885f4d062fd9cdf69b4a9fbb7d2e">Module</a>(<a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp;&amp;) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">//Module&amp; operator=(Module&amp;&amp;) = default;</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="comment">// function wrappers</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="comment">/** Add free function F.</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">         * Example:</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">         * module.function&lt;static_cast&lt;double (*)(double)&gt;(&amp;::sin)&gt;(&quot;sin&quot;);</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">auto</span> F&gt;</div><div class="line"><a name="l01041"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#af9283cdedd5be80f2a03123df5ee9cff"> 1041</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module.html#af9283cdedd5be80f2a03123df5ee9cff">function</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="keywordflow">return</span> add(name, <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="structqjs_1_1fwrapper.html">fwrapper</a>&lt;F&gt;{name});</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">/** Add function object f.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">         * Slower than template version.</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">         * Example: module.function(&quot;sin&quot;, [](double x) { return ::sin(x); });</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> F&gt;</div><div class="line"><a name="l01051"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#aa1275678b079d880cd9f2477552c90a5"> 1051</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module.html#aa1275678b079d880cd9f2477552c90a5">function</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, F&amp;&amp; f)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="keywordflow">return</span> add(name, <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<span class="keyword">decltype</span>(std::function{std::forward&lt;F&gt;(f)})&gt;::wrap(std::forward&lt;F&gt;(f)));</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// class register wrapper</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">/** Helper class to register class members and constructors.</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">         * See fun, constructor.</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">         * Actual registration occurs at object destruction.</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l01063"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html"> 1063</a></span>&#160;        <span class="keyword">class</span> <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        {</div><div class="line"><a name="l01065"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a8d5ba04e197afb963f51918091c397ad"> 1065</a></span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a8d5ba04e197afb963f51918091c397ad">name</a>;</div><div class="line"><a name="l01066"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a"> 1066</a></span>&#160;            <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a>;</div><div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#afc46203984089f91d88540e23a002678"> 1067</a></span>&#160;            <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="classqjs_1_1Context.html">Context</a>::<a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#afc46203984089f91d88540e23a002678">module</a>;</div><div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b"> 1068</a></span>&#160;            <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="classqjs_1_1Context.html">Context</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">context</a>;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l01070"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7c46a74631286642f965a2278c228cf5"> 1070</a></span>&#160;            <span class="keyword">explicit</span> <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7c46a74631286642f965a2278c228cf5">class_registrar</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="classqjs_1_1Context.html">Context</a>::<a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; module, <a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="classqjs_1_1Context.html">Context</a>&amp; context) :</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a8d5ba04e197afb963f51918091c397ad">name</a>(name),</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a>(context<a class="code" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">.</a><a class="code" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">newObject</a><a class="code" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">(</a><a class="code" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">)</a>),</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#afc46203984089f91d88540e23a002678">module</a>(module),</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">context</a>(context)</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3fce9555cabf4b1715a9338697bf192a">class_registrar</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="comment">/** Add functional object f</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span> F&gt;</div><div class="line"><a name="l01083"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3ce7ca743f2d5a4b6bce2c0bd54c88e9"> 1083</a></span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3ce7ca743f2d5a4b6bce2c0bd54c88e9">fun</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, F&amp;&amp; f)</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a>.add(name, std::forward&lt;F&gt;(f));</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            }</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="comment">/** Add class member function or class member variable F</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">             * Example:</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">             * struct T { int var; int func(); }</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">             * auto&amp; module = context.addModule(&quot;module&quot;);</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">             * module.class_&lt;T&gt;(&quot;T&quot;).fun&lt;&amp;T::var&gt;(&quot;var&quot;).fun&lt;&amp;T::func&gt;(&quot;func&quot;);</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">auto</span> F&gt;</div><div class="line"><a name="l01096"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a03e0f9d1e6cace6b982dc1c76f4fdcd7"> 1096</a></span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a03e0f9d1e6cace6b982dc1c76f4fdcd7">fun</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a>.add&lt;F&gt;(name);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="comment">/** Add class constructor</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">             * @tparam Args contructor arguments</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">             * @param name constructor name (if not specified class name will be used)</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l01107"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a935a485219f916949913ca0da81d6692"> 1107</a></span>&#160;            <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&amp; <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a935a485219f916949913ca0da81d6692">constructor</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name = <span class="keywordtype">nullptr</span>)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="keywordflow">if</span>(!name)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    name = <span class="keyword">this</span>-&gt;name;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <a class="code" href="classqjs_1_1Value.html">Value</a> ctor = <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">context</a>.newValue(<a class="code" href="namespaceqjs.html">qjs</a>::<a class="code" href="structqjs_1_1ctor__wrapper.html">ctor_wrapper</a>&lt;T, Args...&gt;{name});</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                JS_SetConstructor(<a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">context</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">.</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>, ctor<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>, <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#afc46203984089f91d88540e23a002678">module</a>.add(name, std::move(ctor));</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="comment">/* TODO: needs casting to base class</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">            template &lt;class B&gt;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">            class_registrar&amp; base()</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">            {</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">                assert(js_traits&lt;std::shared_ptr&lt;B&gt;&gt;::QJSClassId &amp;&amp; &quot;base class is not registered&quot;);</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">                auto base_proto = JS_GetClassProto(context.ctx, js_traits&lt;std::shared_ptr&lt;B&gt;&gt;::QJSClassId);</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">                int err = JS_SetPrototype(context.ctx, prototype.v, base_proto);</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">                JS_FreeValue(context.ctx, base_proto);</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">                if(err &lt; 0)</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">                    throw exception{};</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">                return *this;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">            }</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#ab2b73998043cb498415b0797026c0c04"> 1131</a></span>&#160;            ~<a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#ab2b73998043cb498415b0797026c0c04">class_registrar</a>()</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">context</a>.registerClass&lt;T&gt;(<a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a8d5ba04e197afb963f51918091c397ad">name</a>, std::move(<a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">prototype</a>));</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        };</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="comment">/** Add class to module.</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">         * See \ref class_registrar.</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l01142"></a><span class="lineno"><a class="line" href="classqjs_1_1Context_1_1Module.html#a6ad2518f4aad0751fdb7d09727c8ac9d"> 1142</a></span>&#160;        <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&lt;T&gt; <a class="code" href="classqjs_1_1Context_1_1Module.html#a6ad2518f4aad0751fdb7d09727c8ac9d">class_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">class_registrar</a>&lt;T&gt;{name, *<span class="keyword">this</span>, <a class="code" href="namespaceqjs.html">qjs</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">::</a><a class="code" href="classqjs_1_1Context.html">Context</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">::</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">get</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">(</a><a class="code" href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">ctx</a><a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">)</a>};</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    };</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724"> 1149</a></span>&#160;    std::vector&lt;<a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>, <a class="code" href="structqjs_1_1allocator.html">allocator</a>&lt;<a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&gt;&gt; <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e"> 1151</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">init</a>()</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="quickjs_8c.html#aa28cb15ab0d131c2d312dd3fe3ddcb07">JS_SetContextOpaque</a><a class="code" href="quickjs_8c.html#aa28cb15ab0d131c2d312dd3fe3ddcb07">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#aa28cb15ab0d131c2d312dd3fe3ddcb07">,</a> <span class="keyword">this</span><a class="code" href="quickjs_8c.html#aa28cb15ab0d131c2d312dd3fe3ddcb07">)</a>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <a class="code" href="structqjs_1_1js__traits.html">js_traits</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">&lt;</a><a class="code" href="namespaceqjs_1_1detail.html">detail</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">::</a><a class="code" href="structqjs_1_1detail_1_1function.html">function</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">&gt;</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">::</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">register_class</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">,</a> <span class="stringliteral">&quot;C++ function&quot;</span><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">)</a>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l01158"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#af725fb8083d8c33a37198d6acaf1a836"> 1158</a></span>&#160;    <a class="code" href="classqjs_1_1Context.html#af725fb8083d8c33a37198d6acaf1a836">Context</a>(<a class="code" href="classqjs_1_1Runtime.html">Runtime</a>&amp; rt) : <a class="code" href="classqjs_1_1Context.html">Context</a><a class="code" href="classqjs_1_1Context.html#a4392a23648acfc4bf6b445336efb5007">(</a>rt<a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">.</a><a class="code" href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">rt</a><a class="code" href="classqjs_1_1Context.html#a4392a23648acfc4bf6b445336efb5007">)</a></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    {}</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a4392a23648acfc4bf6b445336efb5007"> 1161</a></span>&#160;    <a class="code" href="classqjs_1_1Context.html#a4392a23648acfc4bf6b445336efb5007">Context</a>(JSRuntime * rt) : <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>{rt}</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a> = <a class="code" href="quickjs_8c.html#ad8aedb643b8753b7a15f6cb2df61945e">JS_NewContext</a><a class="code" href="quickjs_8c.html#ad8aedb643b8753b7a15f6cb2df61945e">(</a>rt<a class="code" href="quickjs_8c.html#ad8aedb643b8753b7a15f6cb2df61945e">)</a>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error{<span class="stringliteral">&quot;qjs: Cannot create context&quot;</span>};</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">init</a><a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">(</a><a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">)</a>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#ad5f7063f928f107a8c6939b207e5a6af"> 1169</a></span>&#160;    <a class="code" href="classqjs_1_1Context.html#ad5f7063f928f107a8c6939b207e5a6af">Context</a>(JSContext * ctx) : <a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>{ctx}, <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>{ctx}</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">init</a><a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">(</a><a class="code" href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">)</a>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="comment">// noncopyable</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="classqjs_1_1Context.html#a3b2f7b65f227a83c56679a35b836eaf8">Context</a>(<span class="keyword">const</span> <a class="code" href="classqjs_1_1Context.html">Context</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a5aeaa5a266944f0d9d515d2b8eac767f"> 1177</a></span>&#160;    ~<a class="code" href="classqjs_1_1Context.html#a5aeaa5a266944f0d9d515d2b8eac767f">Context</a>()</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.clear();</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <a class="code" href="quickjs_8c.html#a1b4fe6eb1b7bcaec6713bd5ac2921f1b">JS_FreeContext</a><a class="code" href="quickjs_8c.html#a1b4fe6eb1b7bcaec6713bd5ac2921f1b">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#a1b4fe6eb1b7bcaec6713bd5ac2921f1b">)</a>;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">/** Create module and return a reference to it */</span></div><div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a88246cb76492cbedf253467fb5291e5c"> 1184</a></span>&#160;    <a class="code" href="classqjs_1_1Context_1_1Module.html">Module</a>&amp; <a class="code" href="classqjs_1_1Context.html#a88246cb76492cbedf253467fb5291e5c">addModule</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.emplace_back(<a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>, name);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">modules</a>.back();</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">/** returns globalThis */</span></div><div class="line"><a name="l01191"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a2275ad206587ece12d220fb8ed0c0744"> 1191</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#a2275ad206587ece12d220fb8ed0c0744">global</a>() { <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8c.html#ad2256fd11b2bdbdd19ddf38f681814bd">JS_GetGlobalObject</a><a class="code" href="quickjs_8c.html#ad2256fd11b2bdbdd19ddf38f681814bd">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#ad2256fd11b2bdbdd19ddf38f681814bd">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>; }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">/** returns new Object() */</span></div><div class="line"><a name="l01194"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548"> 1194</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">newObject</a>() { <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8c.html#afc0d8ea75588216ec132a6e1655524a7">JS_NewObject</a><a class="code" href="quickjs_8c.html#afc0d8ea75588216ec132a6e1655524a7">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#afc0d8ea75588216ec132a6e1655524a7">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>; }</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">/** returns JS value converted from c++ object val */</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a2847ad2611727c0765f54f4a2fde3719"> 1198</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#a2847ad2611727c0765f54f4a2fde3719">newValue</a>(T&amp;&amp; val) { <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a>{<a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>, std::forward&lt;T&gt;(val)}; }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">/** returns current exception associated with context, and resets it. Should be called when qjs::exception is caught */</span></div><div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a3d44c8a62385adeb9248cb38ae0168da"> 1201</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#a3d44c8a62385adeb9248cb38ae0168da">getException</a>() { <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8c.html#a8551eaac7ef616910807cebdc515760d">JS_GetException</a><a class="code" href="quickjs_8c.html#a8551eaac7ef616910807cebdc515760d">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#a8551eaac7ef616910807cebdc515760d">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>; }</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">/** Register class T for conversions to/from std::shared_ptr&lt;T&gt; to work.</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">     * Wherever possible module.class_&lt;T&gt;(&quot;T&quot;)... should be used instead.</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">     * @tparam T class type</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">     * @param name class name in JS engine</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">     * @param proto JS class prototype or JS_UNDEFINED</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#adc20edb42e1c8f5ef2da071d258410dc"> 1210</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classqjs_1_1Context.html#adc20edb42e1c8f5ef2da071d258410dc">registerClass</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, JSValue proto = <a class="code" href="quickjs_8h.html#af4a1e7a17bf31de1fcf48b5a70ed8dd8">JS_NULL</a>)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::shared_ptr&lt;T&gt;&gt;::register_class(<a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a>, name, proto);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251"> 1215</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">eval</a>(std::string_view buffer, <span class="keyword">const</span> <span class="keywordtype">char</span> * filename = <span class="stringliteral">&quot;&lt;eval&gt;&quot;</span>, <span class="keywordtype">unsigned</span> eval_flags = 0)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    {</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        assert(buffer.data()[buffer.size()] == <span class="stringliteral">&#39;\0&#39;</span> &amp;&amp; <span class="stringliteral">&quot;eval buffer is not null-terminated&quot;</span>); <span class="comment">// JS_Eval requirement</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        JSValue v = <a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">JS_Eval</a><a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">,</a> buffer.data()<a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">,</a> buffer.size()<a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">,</a> filename<a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">,</a> eval_flags<a class="code" href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">)</a>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> v<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#a003bfbb1ead4106d2f1fad18cedbdad1"> 1222</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#a003bfbb1ead4106d2f1fad18cedbdad1">evalFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename, <span class="keywordtype">unsigned</span> eval_flags = 0)</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        size_t buf_len;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keyword">auto</span> deleter = [<span class="keyword">this</span>](<span class="keywordtype">void</span> * p) { <a class="code" href="quickjs_8c.html#a80e54dcf9ac687d4ccc2f90273565f30">js_free</a><a class="code" href="quickjs_8c.html#a80e54dcf9ac687d4ccc2f90273565f30">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#a80e54dcf9ac687d4ccc2f90273565f30">,</a> p<a class="code" href="quickjs_8c.html#a80e54dcf9ac687d4ccc2f90273565f30">)</a>; };</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keyword">auto</span> buf = std::unique_ptr&lt;uint8_t, <span class="keyword">decltype</span>(deleter)&gt;{<a class="code" href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">js_load_file</a><a class="code" href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">,</a> &amp;buf_len<a class="code" href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">,</a> filename<a class="code" href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">)</a>, deleter};</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">if</span>(!buf)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error{std::string{<span class="stringliteral">&quot;evalFile: can&#39;t read file: &quot;</span>} + filename};</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">eval</a><a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">(</a>{<span class="keyword">reinterpret_cast</span>&lt;<span class="keywordtype">char</span> *&gt;(buf.get()), buf_len}<a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">,</a> filename<a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">,</a> eval_flags<a class="code" href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">)</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#ace3f753ae2ad418064ea2d2382579a9d"> 1232</a></span>&#160;    <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="classqjs_1_1Context.html#ace3f753ae2ad418064ea2d2382579a9d">fromJSON</a>(std::string_view buffer, <span class="keyword">const</span> <span class="keywordtype">char</span> * filename = <span class="stringliteral">&quot;&lt;fromJSON&gt;&quot;</span>)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        assert(buffer.data()[buffer.size()] == <span class="stringliteral">&#39;\0&#39;</span> &amp;&amp; <span class="stringliteral">&quot;fromJSON buffer is not null-terminated&quot;</span>); <span class="comment">// JS_ParseJSON requirement</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        JSValue v = <a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">JS_ParseJSON</a><a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">(</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">,</a> buffer.data()<a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">,</a> buffer.size()<a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">,</a> filename<a class="code" href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">)</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a><a class="code" href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">ctx</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> v<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">/** Get qjs::Context from JSContext opaque pointer */</span></div><div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90"> 1240</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="classqjs_1_1Context.html">Context</a>&amp; <a class="code" href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">get</a>(JSContext * ctx)</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordtype">void</span> * ptr = <a class="code" href="quickjs_8c.html#a2da4d4ea8b060716bf80ca5808043a0b">JS_GetContextOpaque</a><a class="code" href="quickjs_8c.html#a2da4d4ea8b060716bf80ca5808043a0b">(</a>ctx<a class="code" href="quickjs_8c.html#a2da4d4ea8b060716bf80ca5808043a0b">)</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        assert(ptr);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">reinterpret_cast</span>&lt;<a class="code" href="classqjs_1_1Context.html">Context</a> *&gt;(ptr);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;};</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">/** Conversion traits for Value.</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01Value_01_4.html"> 1251</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;<a class="code" href="classqjs_1_1Value.html">Value</a>&gt;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;{</div><div class="line"><a name="l01253"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01Value_01_4.html#ac4d3d5fdaf363c49f2e4f3ba9bea6d86"> 1253</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="classqjs_1_1Value.html">Value</a> <a class="code" href="structqjs_1_1js__traits_3_01Value_01_4.html#ac4d3d5fdaf363c49f2e4f3ba9bea6d86">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> v)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a>ctx<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">(</a>ctx<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">,</a> v<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01Value_01_4.html#af4727ca29ead31139e17d81f8d54fe68"> 1258</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01Value_01_4.html#af4727ca29ead31139e17d81f8d54fe68">wrap</a>(JSContext * ctx, <a class="code" href="classqjs_1_1Value.html">Value</a> v) <span class="keyword">noexcept</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        assert(ctx == v<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">return</span> v<a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">.</a><a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">release</a><a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">(</a><a class="code" href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">)</a>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;};</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">/** Convert to/from std::function</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"> * @tparam R return type</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment"> * @tparam Args argument types</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> R, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l01270"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html"> 1270</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::function&lt;R(Args...)&gt;&gt;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;{</div><div class="line"><a name="l01272"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#abc36cacd670b6b5f1773734a0586a02b"> 1272</a></span>&#160;    <span class="keyword">static</span> std::function&lt;R(Args...)&gt; <a class="code" href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#abc36cacd670b6b5f1773734a0586a02b">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> fun_obj)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">return</span> [jsfun_obj = Value{ctx, JS_DupValue(ctx, fun_obj)}](Args&amp;&amp; ... args) -&gt; R {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> argc = <span class="keyword">sizeof</span>...(Args);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            JSValue argv[argc];</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_args(jsfun_obj<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, argv, std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            JSValue result = <a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">JS_Call</a><a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">(</a>jsfun_obj<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a><a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">,</a> jsfun_obj<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">,</a> <a class="code" href="quickjs_8h.html#ac363230cf3ec220f5788a1f85976f205">JS_UNDEFINED</a><a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">,</a> argc<a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">,</a> <span class="keyword">const_cast</span>&lt;<a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> *&gt;(argv)<a class="code" href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">)</a>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; argc; i++) JS_FreeValue(jsfun_obj<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, argv[i]);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::unwrap_free&lt;R&gt;(jsfun_obj<a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">.</a><a class="code" href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">ctx</a>, result);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        };</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    }</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">/** Convert from function object functor to JSValue.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">     * Uses detail::function for type-erasure.</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Functor&gt;</div><div class="line"><a name="l01288"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#a6812a672334111ba5228e64816e55490"> 1288</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#a6812a672334111ba5228e64816e55490">wrap</a>(JSContext * ctx, Functor&amp;&amp; functor)</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    {</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keyword">using</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::function;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        assert(<a class="code" href="structqjs_1_1js__traits.html">js_traits</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">&lt;</a><a class="code" href="structqjs_1_1detail_1_1function.html">function</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">&gt;</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">::</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keyword">auto</span> obj = <a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">JS_NewObjectClass</a><a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">(</a>ctx<a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">,</a> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">&lt;</a><a class="code" href="structqjs_1_1detail_1_1function.html">function</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">&gt;</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">::</a><a class="code" href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">QJSClassId</a><a class="code" href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">)</a>;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a>obj<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a>;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keyword">auto</span> fptr = <a class="code" href="structqjs_1_1detail_1_1function.html">function</a>::create(<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a><a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">(</a>ctx<a class="code" href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">)</a>, std::forward&lt;Functor&gt;(functor));</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        fptr-&gt;invoker = [](<a class="code" href="structqjs_1_1detail_1_1function.html">function</a> * self, JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> this_value, <span class="keywordtype">int</span> argc, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> * argv) {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            assert(self);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keyword">auto</span> f = <span class="keyword">reinterpret_cast</span>&lt;Functor *&gt;(&amp;self<a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">-&gt;</a><a class="code" href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">functor</a>);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a>::wrap_call&lt;R, Args...&gt;(ctx, *f, argv);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        };</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        JS_SetOpaque(obj, fptr);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">return</span> obj;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;};</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">/** Convert from std::vector&lt;T&gt; to Array and vice-versa. If Array holds objects that are non-convertible to T throws qjs::exception */</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l01308"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html"> 1308</a></span>&#160;<span class="keyword">struct</span> <a class="code" href="structqjs_1_1js__traits.html">js_traits</a>&lt;std::vector&lt;T&gt;&gt;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;{</div><div class="line"><a name="l01310"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a0a1cc387d5c49e5cb5ae417730d32b1c"> 1310</a></span>&#160;    <span class="keyword">static</span> JSValue <a class="code" href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a0a1cc387d5c49e5cb5ae417730d32b1c">wrap</a>(JSContext * ctx, <span class="keyword">const</span> std::vector&lt;T&gt;&amp; arr) <span class="keyword">noexcept</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keyword">auto</span> jsarray = <a class="code" href="classqjs_1_1Value.html">Value</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a>ctx<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8c.html#ad4ba09e4c7ab9f28c144182e1aacf1f6">JS_NewArray</a><a class="code" href="quickjs_8c.html#ad4ba09e4c7ab9f28c144182e1aacf1f6">(</a>ctx<a class="code" href="quickjs_8c.html#ad4ba09e4c7ab9f28c144182e1aacf1f6">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">(</a>jsarray<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a><a class="code" href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">)</a>)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">return</span> jsarray<a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">.</a><a class="code" href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">v</a>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">try</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; (uint32_t) arr.size(); i++)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                jsarray<a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">[</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">i</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">]</a> = arr[i];</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="keywordflow">catch</span>(<a class="code" href="classqjs_1_1exception.html">exception</a>)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">return</span> std::move(jsarray);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    }</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"><a class="line" href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a9381fc53f1eaf830b702453ca29655f2"> 1328</a></span>&#160;    <span class="keyword">static</span> std::vector&lt;T&gt; <a class="code" href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a9381fc53f1eaf830b702453ca29655f2">unwrap</a>(JSContext * ctx, <a class="code" href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a> jsarr)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordtype">int</span> e = <a class="code" href="quickjs_8c.html#a1fc2c29e89230a9792fd36ae50b270e4">JS_IsArray</a><a class="code" href="quickjs_8c.html#a1fc2c29e89230a9792fd36ae50b270e4">(</a>ctx<a class="code" href="quickjs_8c.html#a1fc2c29e89230a9792fd36ae50b270e4">,</a> jsarr<a class="code" href="quickjs_8c.html#a1fc2c29e89230a9792fd36ae50b270e4">)</a>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">if</span>(e == 0)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            JS_ThrowTypeError(ctx, <span class="stringliteral">&quot;js_traits&lt;std::vector&lt;T&gt;&gt;::unwrap expects array&quot;</span>);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">if</span>(e &lt;= 0)</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classqjs_1_1exception.html">exception</a>{};</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <a class="code" href="classqjs_1_1Value.html">Value</a> jsarray<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">{</a>ctx<a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">,</a> <a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a><a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">(</a>ctx<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">,</a> jsarr<a class="code" href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">)</a><a class="code" href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">}</a>;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        std::vector&lt;T&gt; arr;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keyword">auto</span> len = <span class="keyword">static_cast</span>&lt;int32_t&gt;(jsarray<a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">[</a><span class="stringliteral">&quot;length&quot;</span><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">]</a>);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        arr.reserve((uint32_t) len);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; (uint32_t) len; i++)</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            arr.push_back(<span class="keyword">static_cast</span>&lt;T&gt;(jsarray<a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">[</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">i</a><a class="code" href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">]</a>));</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">return</span> arr;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    }</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;};</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keyword">namespace</span> <a class="code" href="namespaceqjs_1_1detail.html">detail</a> {</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Key&gt;</div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="structqjs_1_1detail_1_1property__proxy.html#af5ab01d0154d84c8f16e93563a37db16"> 1347</a></span>&#160;<a class="code" href="structqjs_1_1detail_1_1property__proxy.html">property_proxy</a>&lt;Key&gt;::<a class="code" href="structqjs_1_1detail_1_1property__proxy.html#af5ab01d0154d84c8f16e93563a37db16">operator</a> <a class="code" href="classqjs_1_1Value.html">Value</a>() <span class="keyword">const</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;{</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">return</span> as&lt;<a class="code" href="classqjs_1_1Value.html">Value</a>&gt;();</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;}</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;} <span class="comment">// namespace qjs</span></div><div class="ttc" id="quickjs_8h_html_afaa20c47565bc704c6c85f3d77254e7d"><div class="ttname"><a href="quickjs_8h.html#afaa20c47565bc704c6c85f3d77254e7d">JS_FreeValue</a></div><div class="ttdeci">static void JS_FreeValue(JSContext *ctx, JSValue v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00637">quickjs.h:637</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a0baf8fad2f079e722cb71afbd55f2ce9"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a0baf8fad2f079e722cb71afbd55f2ce9">qjs::Context::Module::add</a></div><div class="ttdeci">Module &amp; add(const char *name, Value value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01014">quickjspp.hpp:1014</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a3efc38213458da2038a9ac43eb960375"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a3efc38213458da2038a9ac43eb960375">qjs::Context::Module::m</a></div><div class="ttdeci">JSModuleDef * m</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00981">quickjspp.hpp:981</a></div></div>
<div class="ttc" id="quickjs_8c_html_a4b710876403548c1ad3edc7a7719c559"><div class="ttname"><a href="quickjs_8c.html#a4b710876403548c1ad3edc7a7719c559">js_malloc_rt</a></div><div class="ttdeci">void * js_malloc_rt(JSRuntime *rt, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01266">quickjs.c:1266</a></div></div>
<div class="ttc" id="quickjs_8c_html_a62617fe11025d2e5a545db069fc28e64"><div class="ttname"><a href="quickjs_8c.html#a62617fe11025d2e5a545db069fc28e64">JS_SetPropertyStr</a></div><div class="ttdeci">int JS_SetPropertyStr(JSContext *ctx, JSValueConst this_obj, const char *prop, JSValue val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l08717">quickjs.c:8717</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a7c46a74631286642f965a2278c228cf5"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7c46a74631286642f965a2278c228cf5">qjs::Context::Module::class_registrar::class_registrar</a></div><div class="ttdeci">class_registrar(const char *name, qjs::Context::Module &amp;module, qjs::Context &amp;context)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01070">quickjspp.hpp:1070</a></div></div>
<div class="ttc" id="quickjs_8c_html_a1b4fe6eb1b7bcaec6713bd5ac2921f1b"><div class="ttname"><a href="quickjs_8c.html#a1b4fe6eb1b7bcaec6713bd5ac2921f1b">JS_FreeContext</a></div><div class="ttdeci">void JS_FreeContext(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02253">quickjs.c:2253</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a7cf47d05a024251db286b374e843254b"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a7cf47d05a024251db286b374e843254b">qjs::Context::Module::class_registrar::context</a></div><div class="ttdeci">qjs::Context &amp; context</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01068">quickjspp.hpp:1068</a></div></div>
<div class="ttc" id="quickjs_8c_html_a80e54dcf9ac687d4ccc2f90273565f30"><div class="ttname"><a href="quickjs_8c.html#a80e54dcf9ac687d4ccc2f90273565f30">js_free</a></div><div class="ttdeci">void js_free(JSContext *ctx, void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01328">quickjs.c:1328</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a2847ad2611727c0765f54f4a2fde3719"><div class="ttname"><a href="classqjs_1_1Context.html#a2847ad2611727c0765f54f4a2fde3719">qjs::Context::newValue</a></div><div class="ttdeci">Value newValue(T &amp;&amp;val)</div><div class="ttdoc">returns JS value converted from c++ object val </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01198">quickjspp.hpp:1198</a></div></div>
<div class="ttc" id="quickjs_8c_html_a69e19dda8a93d613203e0baa06f0ed8d"><div class="ttname"><a href="quickjs_8c.html#a69e19dda8a93d613203e0baa06f0ed8d">js_free_rt</a></div><div class="ttdeci">void js_free_rt(JSRuntime *rt, void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01271">quickjs.c:1271</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01JSValue_01_4_html_a6097b6ac58491915d24ac160b001f030"><div class="ttname"><a href="structqjs_1_1js__traits_3_01JSValue_01_4.html#a6097b6ac58491915d24ac160b001f030">qjs::js_traits&lt; JSValue &gt;::unwrap</a></div><div class="ttdeci">static JSValue unwrap(JSContext *ctx, JSValueConst v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00085">quickjspp.hpp:85</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4_html_a046f811ae16e0cb24170a8425f3e8780"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a046f811ae16e0cb24170a8425f3e8780">qjs::js_traits&lt; std::shared_ptr&lt; T &gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, std::shared_ptr&lt; T &gt; ptr)</div><div class="ttdoc">Create a JSValue from std::shared_ptr&lt;T&gt;. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00542">quickjspp.hpp:542</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_html_aab2e574fd3e63cbde699e6df9218a66c"><div class="ttname"><a href="structqjs_1_1js__property__traits.html#aab2e574fd3e63cbde699e6df9218a66c">qjs::js_property_traits::set_property</a></div><div class="ttdeci">static void set_property(JSContext *ctx, JSValue this_obj, Key key, JSValue value)</div></div>
<div class="ttc" id="namespaceqjs_html"><div class="ttname"><a href="namespaceqjs.html">qjs</a></div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00017">quickjspp.hpp:17</a></div></div>
<div class="ttc" id="quickjs_8c_html_a1a4c02a29525d5cb2085dd8bca3af350"><div class="ttname"><a href="quickjs_8c.html#a1a4c02a29525d5cb2085dd8bca3af350">JS_Call</a></div><div class="ttdeci">JSValue JS_Call(JSContext *ctx, JSValueConst func_obj, JSValueConst this_obj, int argc, JSValueConst *argv)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l18504">quickjs.c:18504</a></div></div>
<div class="ttc" id="quickjs_8h_html_a589fb368a95830fddfde74257423513e"><div class="ttname"><a href="quickjs_8h.html#a589fb368a95830fddfde74257423513e">JS_PROP_ENUMERABLE</a></div><div class="ttdeci">#define JS_PROP_ENUMERABLE</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00265">quickjs.h:265</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_3_01uint32__t_01_4_html_af19da02fec28059477a39b16c531a97c"><div class="ttname"><a href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#af19da02fec28059477a39b16c531a97c">qjs::js_property_traits&lt; uint32_t &gt;::get_property</a></div><div class="ttdeci">static JSValue get_property(JSContext *ctx, JSValue this_obj, uint32_t idx) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00727">quickjspp.hpp:727</a></div></div>
<div class="ttc" id="quickjs_8c_html_ad80a65b72c3a346d8a0047858a5f0b13"><div class="ttname"><a href="quickjs_8c.html#ad80a65b72c3a346d8a0047858a5f0b13">JS_FreeRuntime</a></div><div class="ttdeci">void JS_FreeRuntime(JSRuntime *rt)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01907">quickjs.c:1907</a></div></div>
<div class="ttc" id="quickjs_8h_html_af4a1e7a17bf31de1fcf48b5a70ed8dd8"><div class="ttname"><a href="quickjs_8h.html#af4a1e7a17bf31de1fcf48b5a70ed8dd8">JS_NULL</a></div><div class="ttdeci">#define JS_NULL</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00255">quickjs.h:255</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01detail_1_1function_01_4_html_afe383c63f389edaf9f878cd30062d37f"><div class="ttname"><a href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#afe383c63f389edaf9f878cd30062d37f">qjs::js_traits&lt; detail::function &gt;::register_class</a></div><div class="ttdeci">static void register_class(JSContext *ctx, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00655">quickjspp.hpp:655</a></div></div>
<div class="ttc" id="quickjs_8c_html_a8551eaac7ef616910807cebdc515760d"><div class="ttname"><a href="quickjs_8c.html#a8551eaac7ef616910807cebdc515760d">JS_GetException</a></div><div class="ttdeci">JSValue JS_GetException(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l06279">quickjs.c:6279</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01Value_01_4_html_ac4d3d5fdaf363c49f2e4f3ba9bea6d86"><div class="ttname"><a href="structqjs_1_1js__traits_3_01Value_01_4.html#ac4d3d5fdaf363c49f2e4f3ba9bea6d86">qjs::js_traits&lt; Value &gt;::unwrap</a></div><div class="ttdeci">static Value unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01253">quickjspp.hpp:1253</a></div></div>
<div class="ttc" id="quickjs_8c_html_a04f589361a4fbc30d997402e92a50de2"><div class="ttname"><a href="quickjs_8c.html#a04f589361a4fbc30d997402e92a50de2">JS_GetPropertyStr</a></div><div class="ttdeci">JSValue JS_GetPropertyStr(JSContext *ctx, JSValueConst this_obj, const char *prop)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l07896">quickjs.c:7896</a></div></div>
<div class="ttc" id="quickjs_8h_html_ab56f74e66d354104a7af2ecb922960e4"><div class="ttname"><a href="quickjs_8h.html#ab56f74e66d354104a7af2ecb922960e4">JS_PROP_WRITABLE</a></div><div class="ttdeci">#define JS_PROP_WRITABLE</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00264">quickjs.h:264</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_add0335ad35de9949210e4a5f3fa0751a"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#add0335ad35de9949210e4a5f3fa0751a">qjs::Context::Module::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00983">quickjspp.hpp:983</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01T_01_5_01_4_html_a56209aec4204470bd9528be7027da5a0"><div class="ttname"><a href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a56209aec4204470bd9528be7027da5a0">qjs::js_traits&lt; T * &gt;::unwrap</a></div><div class="ttdeci">static T * unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00602">quickjspp.hpp:602</a></div></div>
<div class="ttc" id="namespaceqjs_html_a0b13a25aec789e76e1f65a109faaf3f7"><div class="ttname"><a href="namespaceqjs.html#a0b13a25aec789e76e1f65a109faaf3f7">qjs::~js_string</a></div><div class="ttdeci">~js_string()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00204">quickjspp.hpp:204</a></div></div>
<div class="ttc" id="classqjs_1_1Runtime_html_a4ed2f53478c9503702827ed7b3503e96"><div class="ttname"><a href="classqjs_1_1Runtime.html#a4ed2f53478c9503702827ed7b3503e96">qjs::Runtime::Runtime</a></div><div class="ttdeci">Runtime(const Runtime &amp;)=delete</div></div>
<div class="ttc" id="classqjs_1_1Value_html_a4e7fefdc18a3dc4f54b6b767433d3198"><div class="ttname"><a href="classqjs_1_1Value.html#a4e7fefdc18a3dc4f54b6b767433d3198">qjs::Value::operator!=</a></div><div class="ttdeci">bool operator!=(const Value &amp;rhs) const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00846">quickjspp.hpp:846</a></div></div>
<div class="ttc" id="structqjs_1_1ctor__wrapper_html"><div class="ttname"><a href="structqjs_1_1ctor__wrapper.html">qjs::ctor_wrapper</a></div><div class="ttdoc">A wrapper type for constructor of type T with arguments Args. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00442">quickjspp.hpp:442</a></div></div>
<div class="ttc" id="quickjs_8h_html_a93abffa925714e249a6aa2f4ae7900f6"><div class="ttname"><a href="quickjs_8h.html#a93abffa925714e249a6aa2f4ae7900f6">JS_NewBool</a></div><div class="ttdeci">static js_force_inline JSValue JS_NewBool(JSContext *ctx, JS_BOOL val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00499">quickjs.h:499</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01fwrapper_3_01F_00_01PassThis_01_4_01_4_html_a8a5279bd3b11cdfc756aa5038fb59b47"><div class="ttname"><a href="structqjs_1_1js__traits_3_01fwrapper_3_01F_00_01PassThis_01_4_01_4.html#a8a5279bd3b11cdfc756aa5038fb59b47">qjs::js_traits&lt; fwrapper&lt; F, PassThis &gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, fwrapper&lt; F, PassThis &gt; fw) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00396">quickjspp.hpp:396</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a3b16e4ca57ab1de004a35ae1930b40d2"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a3b16e4ca57ab1de004a35ae1930b40d2">qjs::Context::Module::Module</a></div><div class="ttdeci">Module(JSContext *ctx, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00988">quickjspp.hpp:988</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_a2239084ae6320d2f421ec06b05b51382"><div class="ttname"><a href="namespaceqjs_1_1detail.html#a2239084ae6320d2f421ec06b05b51382">qjs::detail::wrap_call</a></div><div class="ttdeci">JSValue wrap_call(JSContext *ctx, Callable &amp;&amp;f, JSValueConst *argv) noexcept</div><div class="ttdoc">Helper function to call f with an array of JSValues. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00313">quickjspp.hpp:313</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_af9283cdedd5be80f2a03123df5ee9cff"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#af9283cdedd5be80f2a03123df5ee9cff">qjs::Context::Module::function</a></div><div class="ttdeci">Module &amp; function(const char *name)</div><div class="ttdoc">Add free function F. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01041">quickjspp.hpp:1041</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4_html_abc36cacd670b6b5f1773734a0586a02b"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#abc36cacd670b6b5f1773734a0586a02b">qjs::js_traits&lt; std::function&lt; R(Args...)&gt; &gt;::unwrap</a></div><div class="ttdeci">static std::function&lt; R(Args...)&gt; unwrap(JSContext *ctx, JSValueConst fun_obj)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01272">quickjspp.hpp:1272</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_aef4d95b41d8e52cd3f2adcde79021d80"><div class="ttname"><a href="classqjs_1_1Value.html#aef4d95b41d8e52cd3f2adcde79021d80">qjs::Value::ctx</a></div><div class="ttdeci">JSContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00801">quickjspp.hpp:801</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01Value_01_4_html_af4727ca29ead31139e17d81f8d54fe68"><div class="ttname"><a href="structqjs_1_1js__traits_3_01Value_01_4.html#af4727ca29ead31139e17d81f8d54fe68">qjs::js_traits&lt; Value &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, Value v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01258">quickjspp.hpp:1258</a></div></div>
<div class="ttc" id="quickjs_8c_html_a4f56d0a794368a8861c89819fc79cdb5"><div class="ttname"><a href="quickjs_8c.html#a4f56d0a794368a8861c89819fc79cdb5">JS_NewClassID</a></div><div class="ttdeci">JSClassID JS_NewClassID(JSClassID *pclass_id)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03337">quickjs.c:3337</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a329cdcdab71bdeec91a081d013b01f4e"><div class="ttname"><a href="classqjs_1_1Value.html#a329cdcdab71bdeec91a081d013b01f4e">qjs::Value::operator!=</a></div><div class="ttdeci">bool operator!=(JSValueConst other) const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00837">quickjspp.hpp:837</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a5a34a3f4872a04a17363e892c5da5f62"><div class="ttname"><a href="structqjs_1_1allocator.html#a5a34a3f4872a04a17363e892c5da5f62">qjs::allocator::allocator</a></div><div class="ttdeci">constexpr allocator(JSRuntime *rt) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00029">quickjspp.hpp:29</a></div></div>
<div class="ttc" id="quickjs_8c_html_afc0d8ea75588216ec132a6e1655524a7"><div class="ttname"><a href="quickjs_8c.html#afc0d8ea75588216ec132a6e1655524a7">JS_NewObject</a></div><div class="ttdeci">JSValue JS_NewObject(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l04868">quickjs.c:4868</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_a1ecfe9898fdc564669510d3f2fe7dbce"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#a1ecfe9898fdc564669510d3f2fe7dbce">qjs::detail::property_proxy::key</a></div><div class="ttdeci">Key key</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00741">quickjspp.hpp:741</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html"><div class="ttname"><a href="namespaceqjs_1_1detail.html">qjs::detail</a></div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00262">quickjspp.hpp:262</a></div></div>
<div class="ttc" id="quickjs_8c_html_a8f9200abd5af97fd0411fe053cb021e0"><div class="ttname"><a href="quickjs_8c.html#a8f9200abd5af97fd0411fe053cb021e0">JS_Eval</a></div><div class="ttdeci">JSValue JS_Eval(JSContext *ctx, const char *input, size_t input_len, const char *filename, int eval_flags)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l33138">quickjs.c:33138</a></div></div>
<div class="ttc" id="quickjs_8h_html_ad80a83d73e9b7d872b88fbf2943aebe9"><div class="ttname"><a href="quickjs_8h.html#ad80a83d73e9b7d872b88fbf2943aebe9">JS_IsException</a></div><div class="ttdeci">static JS_BOOL JS_IsException(JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00599">quickjs.h:599</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a3b2f7b65f227a83c56679a35b836eaf8"><div class="ttname"><a href="classqjs_1_1Context.html#a3b2f7b65f227a83c56679a35b836eaf8">qjs::Context::Context</a></div><div class="ttdeci">Context(const Context &amp;)=delete</div></div>
<div class="ttc" id="quickjs_8c_html_a3f0ebc39396c0cd909ec04585f92b1b9"><div class="ttname"><a href="quickjs_8c.html#a3f0ebc39396c0cd909ec04585f92b1b9">JS_IsRegisteredClass</a></div><div class="ttdeci">BOOL JS_IsRegisteredClass(JSRuntime *rt, JSClassID class_id)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03349">quickjs.c:3349</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_a65d0ddd24470d7ce93d2352b5a5cdb33"><div class="ttname"><a href="namespaceqjs_1_1detail.html#a65d0ddd24470d7ce93d2352b5a5cdb33">qjs::detail::unwrap_args</a></div><div class="ttdeci">std::tuple&lt; std::decay_t&lt; Args &gt;... &gt; unwrap_args(JSContext *ctx, JSValueConst *argv)</div><div class="ttdoc">Helper function to convert an array of JSValues to a tuple. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00298">quickjspp.hpp:298</a></div></div>
<div class="ttc" id="quickjs_8c_html_a343a343b16bc3c9875050e99ee0d2884"><div class="ttname"><a href="quickjs_8c.html#a343a343b16bc3c9875050e99ee0d2884">JS_JSONStringify</a></div><div class="ttdeci">JSValue JS_JSONStringify(JSContext *ctx, JSValueConst obj, JSValueConst replacer, JSValueConst space0)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l43409">quickjs.c:43409</a></div></div>
<div class="ttc" id="quickjs_8h_html_ac9ac6d792cab919178eb83a57bc26683"><div class="ttname"><a href="quickjs_8h.html#ac9ac6d792cab919178eb83a57bc26683">JS_VALUE_GET_PTR</a></div><div class="ttdeci">#define JS_VALUE_GET_PTR(v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00216">quickjs.h:216</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_acf399d3f72253cdef48d48abfd97dc1d"><div class="ttname"><a href="namespaceqjs_1_1detail.html#acf399d3f72253cdef48d48abfd97dc1d">qjs::detail::wrap_this_call</a></div><div class="ttdeci">JSValue wrap_this_call(JSContext *ctx, Callable &amp;&amp;f, JSValueConst this_value, JSValueConst *argv) noexcept</div><div class="ttdoc">Same as wrap_call, but pass this_value as first argument. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00338">quickjspp.hpp:338</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_ad04b949f09968e4677fcfc1141b4b180"><div class="ttname"><a href="classqjs_1_1Value.html#ad04b949f09968e4677fcfc1141b4b180">qjs::Value::operator JSValue</a></div><div class="ttdeci">operator JSValue() &amp;&amp;</div><div class="ttdoc">Implicit conversion to JSValue (rvalue only). </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00871">quickjspp.hpp:871</a></div></div>
<div class="ttc" id="quickjs_8c_html_ac29cc4ec49efa0f0308e494316ce5139"><div class="ttname"><a href="quickjs_8c.html#ac29cc4ec49efa0f0308e494316ce5139">JS_NewCModule</a></div><div class="ttdeci">JSModuleDef * JS_NewCModule(JSContext *ctx, const char *name_str, JSModuleInitFunc *func)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l26805">quickjs.c:26805</a></div></div>
<div class="ttc" id="quickjs_8c_html_a1fc2c29e89230a9792fd36ae50b270e4"><div class="ttname"><a href="quickjs_8c.html#a1fc2c29e89230a9792fd36ae50b270e4">JS_IsArray</a></div><div class="ttdeci">int JS_IsArray(JSContext *ctx, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l11818">quickjs.c:11818</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_aa0eaa45d4cb0f1d7d7c42bccaef35ef6"><div class="ttname"><a href="classqjs_1_1Value.html#aa0eaa45d4cb0f1d7d7c42bccaef35ef6">qjs::Value::operator T</a></div><div class="ttdeci">operator T() const</div><div class="ttdoc">Explicit conversion to any type. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00862">quickjspp.hpp:862</a></div></div>
<div class="ttc" id="classqjs_1_1Runtime_html_a0860a1339ff567f9f603c7bed4d670f9"><div class="ttname"><a href="classqjs_1_1Runtime.html#a0860a1339ff567f9f603c7bed4d670f9">qjs::Runtime::Runtime</a></div><div class="ttdeci">Runtime()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00950">quickjspp.hpp:950</a></div></div>
<div class="ttc" id="classqjs_1_1Runtime_html_a44c5deb57118d67e36f2e002f393ff43"><div class="ttname"><a href="classqjs_1_1Runtime.html#a44c5deb57118d67e36f2e002f393ff43">qjs::Runtime::~Runtime</a></div><div class="ttdeci">~Runtime()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00960">quickjspp.hpp:960</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a405fd50a6096c420219ef87574bc1724"><div class="ttname"><a href="classqjs_1_1Context.html#a405fd50a6096c420219ef87574bc1724">qjs::Context::modules</a></div><div class="ttdeci">std::vector&lt; Module, allocator&lt; Module &gt; &gt; modules</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01149">quickjspp.hpp:1149</a></div></div>
<div class="ttc" id="quickjs_8c_html_a369af749a1fb181216fe8a8b55f841b0"><div class="ttname"><a href="quickjs_8c.html#a369af749a1fb181216fe8a8b55f841b0">JS_AddModuleExport</a></div><div class="ttdeci">int JS_AddModuleExport(JSContext *ctx, JSModuleDef *m, const char *export_name)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l26818">quickjs.c:26818</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a236f7962a53547473290e634b20e7682"><div class="ttname"><a href="structqjs_1_1allocator.html#a236f7962a53547473290e634b20e7682">qjs::allocator::allocator</a></div><div class="ttdeci">constexpr allocator(const allocator&lt; U &gt; &amp;other) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00036">quickjspp.hpp:36</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1string_01_4_html_a9511dd47284884284b365ff1bd3de9d5"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#a9511dd47284884284b365ff1bd3de9d5">qjs::js_traits&lt; std::string &gt;::unwrap</a></div><div class="ttdeci">static std::string unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00235">quickjspp.hpp:235</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html">qjs::Context::Module::class_registrar</a></div><div class="ttdoc">Helper class to register class members and constructors. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01063">quickjspp.hpp:1063</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a1657b03f6a4f44a28aa40835b5cee763"><div class="ttname"><a href="structqjs_1_1allocator.html#a1657b03f6a4f44a28aa40835b5cee763">qjs::allocator::operator!=</a></div><div class="ttdeci">bool operator!=(const allocator&lt; U &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00053">quickjspp.hpp:53</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4_html_a34eea271d3cd85ddae26e5c33b400070"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a34eea271d3cd85ddae26e5c33b400070">qjs::js_traits&lt; std::shared_ptr&lt; T &gt; &gt;::unwrap</a></div><div class="ttdeci">static const std::shared_ptr&lt; T &gt; &amp; unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00566">quickjspp.hpp:566</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a5ee42d3287ecb77644036362f9115e16"><div class="ttname"><a href="classqjs_1_1Value.html#a5ee42d3287ecb77644036362f9115e16">qjs::Value::Value</a></div><div class="ttdeci">Value(Value &amp;&amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00819">quickjspp.hpp:819</a></div></div>
<div class="ttc" id="quickjs_8c_html_aa2ef5af1544a3012f91a80c98c326b8f"><div class="ttname"><a href="quickjs_8c.html#aa2ef5af1544a3012f91a80c98c326b8f">JS_NewAtom</a></div><div class="ttdeci">JSAtom JS_NewAtom(JSContext *ctx, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02931">quickjs.c:2931</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a5aeaa5a266944f0d9d515d2b8eac767f"><div class="ttname"><a href="classqjs_1_1Context.html#a5aeaa5a266944f0d9d515d2b8eac767f">qjs::Context::~Context</a></div><div class="ttdeci">~Context()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01177">quickjspp.hpp:1177</a></div></div>
<div class="ttc" id="quickjs_8c_html_a1951b8aab94369f326d8c0720097c523"><div class="ttname"><a href="quickjs_8c.html#a1951b8aab94369f326d8c0720097c523">JS_GetOpaque2</a></div><div class="ttdeci">void * JS_GetOpaque2(JSContext *ctx, JSValueConst obj, JSClassID class_id)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l09715">quickjs.c:9715</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_acffffa8a01df1832830c23631bdfcd6c"><div class="ttname"><a href="classqjs_1_1Value.html#acffffa8a01df1832830c23631bdfcd6c">qjs::Value::~Value</a></div><div class="ttdeci">~Value()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00849">quickjspp.hpp:849</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_af11fd023b991d7d6adc5c18142ded292"><div class="ttname"><a href="classqjs_1_1Value.html#af11fd023b991d7d6adc5c18142ded292">qjs::Value::operator[]</a></div><div class="ttdeci">detail::property_proxy&lt; Key &gt; operator[](Key key)</div><div class="ttdoc">Access JS properties. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00876">quickjspp.hpp:876</a></div></div>
<div class="ttc" id="quickjs_8c_html_ad4ba09e4c7ab9f28c144182e1aacf1f6"><div class="ttname"><a href="quickjs_8c.html#ad4ba09e4c7ab9f28c144182e1aacf1f6">JS_NewArray</a></div><div class="ttdeci">JSValue JS_NewArray(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l04862">quickjs.c:4862</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1function_html_a416a24c42e5b38a43f957096822b1949"><div class="ttname"><a href="structqjs_1_1detail_1_1function.html#a416a24c42e5b38a43f957096822b1949">qjs::detail::function::create</a></div><div class="ttdeci">static function * create(JSRuntime *rt, Functor &amp;&amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00626">quickjspp.hpp:626</a></div></div>
<div class="ttc" id="structqjs_1_1fwrapper_html_a5ff19a2d124be6bbac4b5079d27ca0c6"><div class="ttname"><a href="structqjs_1_1fwrapper.html#a5ff19a2d124be6bbac4b5079d27ca0c6">qjs::fwrapper::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">&quot;name&quot; property of the JS function object (not defined if nullptr) </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00389">quickjspp.hpp:389</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_ad5f7063f928f107a8c6939b207e5a6af"><div class="ttname"><a href="classqjs_1_1Context.html#ad5f7063f928f107a8c6939b207e5a6af">qjs::Context::Context</a></div><div class="ttdeci">Context(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01169">quickjspp.hpp:1169</a></div></div>
<div class="ttc" id="quickjs_8h_html_ab5b643c1ec038a6ce73ff6612efe73c2"><div class="ttname"><a href="quickjs_8h.html#ab5b643c1ec038a6ce73ff6612efe73c2">JSValueConst</a></div><div class="ttdeci">#define JSValueConst</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00208">quickjs.h:208</a></div></div>
<div class="ttc" id="quickjs_8c_html_af1866c7f8a91153f11602a2b521d9399"><div class="ttname"><a href="quickjs_8c.html#af1866c7f8a91153f11602a2b521d9399">JS_GetRuntime</a></div><div class="ttdeci">JSRuntime * JS_GetRuntime(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02320">quickjs.c:2320</a></div></div>
<div class="ttc" id="quickjs_8c_html_ae0bc4f65da64810facb2cb9e476eda2e"><div class="ttname"><a href="quickjs_8c.html#ae0bc4f65da64810facb2cb9e476eda2e">JS_FreeCString</a></div><div class="ttdeci">void JS_FreeCString(JSContext *ctx, const char *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l04033">quickjs.c:4033</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a3fce9555cabf4b1715a9338697bf192a"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3fce9555cabf4b1715a9338697bf192a">qjs::Context::Module::class_registrar::class_registrar</a></div><div class="ttdeci">class_registrar(const class_registrar &amp;)=delete</div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a0011885f4d062fd9cdf69b4a9fbb7d2e"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a0011885f4d062fd9cdf69b4a9fbb7d2e">qjs::Context::Module::Module</a></div><div class="ttdeci">Module(Module &amp;&amp;)=default</div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a8d5ba04e197afb963f51918091c397ad"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a8d5ba04e197afb963f51918091c397ad">qjs::Context::Module::class_registrar::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01065">quickjspp.hpp:1065</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_ab8ec63e4233d09332fb114fad78db380"><div class="ttname"><a href="classqjs_1_1Value.html#ab8ec63e4233d09332fb114fad78db380">qjs::Value::operator==</a></div><div class="ttdeci">bool operator==(JSValueConst other) const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00832">quickjspp.hpp:832</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4_html_a6812a672334111ba5228e64816e55490"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1function_3_01R_07Args_8_8_8_08_4_01_4.html#a6812a672334111ba5228e64816e55490">qjs::js_traits&lt; std::function&lt; R(Args...)&gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, Functor &amp;&amp;functor)</div><div class="ttdoc">Convert from function object functor to JSValue. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01288">quickjspp.hpp:1288</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a57d738d3c1035c1cccbec16676fa59db"><div class="ttname"><a href="classqjs_1_1Value.html#a57d738d3c1035c1cccbec16676fa59db">qjs::Value::isError</a></div><div class="ttdeci">bool isError() const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00854">quickjspp.hpp:854</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_html"><div class="ttname"><a href="structqjs_1_1js__traits.html">qjs::js_traits</a></div><div class="ttdoc">Javascript conversion traits. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00065">quickjspp.hpp:65</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a03e0f9d1e6cace6b982dc1c76f4fdcd7"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a03e0f9d1e6cace6b982dc1c76f4fdcd7">qjs::Context::Module::class_registrar::fun</a></div><div class="ttdeci">class_registrar &amp; fun(const char *name)</div><div class="ttdoc">Add class member function or class member variable F Example: struct T { int var; int func(); } auto&amp;...</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01096">quickjspp.hpp:1096</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1function_html"><div class="ttname"><a href="structqjs_1_1detail_1_1function.html">qjs::detail::function</a></div><div class="ttdoc">A faster std::function-like object with type erasure. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00616">quickjspp.hpp:616</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_aae629cc551168d549a405db5c762b61e"><div class="ttname"><a href="classqjs_1_1Context.html#aae629cc551168d549a405db5c762b61e">qjs::Context::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01151">quickjspp.hpp:1151</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4_html_a8fac9b9bae12cbc7470c19050739b830"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#a8fac9b9bae12cbc7470c19050739b830">qjs::js_traits&lt; std::shared_ptr&lt; T &gt; &gt;::QJSClassId</a></div><div class="ttdeci">static JSClassID QJSClassId</div><div class="ttdoc">Registered class id in QuickJS. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00498">quickjspp.hpp:498</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1string__view_01_4_html_ad9dac01710453b7af63a997961c1fa6a"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#ad9dac01710453b7af63a997961c1fa6a">qjs::js_traits&lt; std::string_view &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, std::string_view str) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00225">quickjspp.hpp:225</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_afc46203984089f91d88540e23a002678"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#afc46203984089f91d88540e23a002678">qjs::Context::Module::class_registrar::module</a></div><div class="ttdeci">qjs::Context::Module &amp; module</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01067">quickjspp.hpp:1067</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_afa425b198f80c0e81b8415b3d898539a"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#afa425b198f80c0e81b8415b3d898539a">qjs::detail::property_proxy::as</a></div><div class="ttdeci">T as() const</div><div class="ttdoc">Conversion helper function. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00745">quickjspp.hpp:745</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_aeafa4cad50424999587a30d7d3994251"><div class="ttname"><a href="classqjs_1_1Context.html#aeafa4cad50424999587a30d7d3994251">qjs::Context::eval</a></div><div class="ttdeci">Value eval(std::string_view buffer, const char *filename=&quot;&lt;eval&gt;&quot;, unsigned eval_flags=0)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01215">quickjspp.hpp:1215</a></div></div>
<div class="ttc" id="classqjs_1_1Runtime_html"><div class="ttname"><a href="classqjs_1_1Runtime.html">qjs::Runtime</a></div><div class="ttdoc">Thin wrapper over JSRuntime * rt Calls JS_FreeRuntime on destruction. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00945">quickjspp.hpp:945</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_abd7b1697b6736617ad2d571adea7b68f"><div class="ttname"><a href="classqjs_1_1Value.html#abd7b1697b6736617ad2d571adea7b68f">qjs::Value::add</a></div><div class="ttdeci">std::enable_if_t&lt; std::is_member_object_pointer_v&lt; decltype(M)&gt;, Value &amp; &gt; add(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00904">quickjspp.hpp:904</a></div></div>
<div class="ttc" id="quickjs_8c_html_ac34cc554aab1e98c45a7f845fff64385"><div class="ttname"><a href="quickjs_8c.html#ac34cc554aab1e98c45a7f845fff64385">JS_NewStringLen</a></div><div class="ttdeci">JSValue JS_NewStringLen(JSContext *ctx, const char *buf, size_t buf_len)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03827">quickjs.c:3827</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_html_a728896ee56f225c3babba3fa8f6b418d"><div class="ttname"><a href="structqjs_1_1js__property__traits.html#a728896ee56f225c3babba3fa8f6b418d">qjs::js_property_traits::get_property</a></div><div class="ttdeci">static JSValue get_property(JSContext *ctx, JSValue this_obj, Key key)</div></div>
<div class="ttc" id="quickjs_8h_html_a451d6a9cf9c7412aa33211fd887c7368"><div class="ttname"><a href="quickjs_8h.html#a451d6a9cf9c7412aa33211fd887c7368">JSClassID</a></div><div class="ttdeci">uint32_t JSClassID</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00053">quickjs.h:53</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_ae3977f7f157a8a60242089cfd8578d54"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#ae3977f7f157a8a60242089cfd8578d54">qjs::detail::property_proxy::operator T</a></div><div class="ttdeci">operator T() const</div><div class="ttdoc">Explicit conversion operator (to any type) </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00752">quickjspp.hpp:752</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_ac10c8a8f94539ee1224b46b9007ab4af"><div class="ttname"><a href="namespaceqjs_1_1detail.html#ac10c8a8f94539ee1224b46b9007ab4af">qjs::detail::wrap_args</a></div><div class="ttdeci">void wrap_args(JSContext *ctx, JSValue *argv, Args &amp;&amp;... args)</div><div class="ttdoc">Converts C++ args to JSValue array. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00373">quickjspp.hpp:373</a></div></div>
<div class="ttc" id="quickjs_8c_html_ae2829a2d31c667739617023e2374a6b2"><div class="ttname"><a href="quickjs_8c.html#ae2829a2d31c667739617023e2374a6b2">JS_ToInt64</a></div><div class="ttdeci">int JS_ToInt64(JSContext *ctx, int64_t *pres, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l10729">quickjs.c:10729</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a21c2f81a213eb9d0c52d58d09bbf61a3"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a21c2f81a213eb9d0c52d58d09bbf61a3">qjs::Context::Module::add</a></div><div class="ttdeci">Module &amp; add(const char *name, T value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01023">quickjspp.hpp:1023</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01ctor__wrapper_3_01T_00_01Args_8_8_8_01_4_01_4_html_ac3e4ebb181720971396c1bf6008a997b"><div class="ttname"><a href="structqjs_1_1js__traits_3_01ctor__wrapper_3_01T_00_01Args_8_8_8_01_4_01_4.html#ac3e4ebb181720971396c1bf6008a997b">qjs::js_traits&lt; ctor_wrapper&lt; T, Args... &gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, ctor_wrapper&lt; T, Args... &gt; cw) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00453">quickjspp.hpp:453</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01const_01char_01_5_01_4_html_ac03002f04b35482ae7ad9ac3a693ddbf"><div class="ttname"><a href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ac03002f04b35482ae7ad9ac3a693ddbf">qjs::js_traits&lt; const char * &gt;::unwrap</a></div><div class="ttdeci">static detail::js_string unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00255">quickjspp.hpp:255</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1get__set_3_01M_01_4_html_ad78011ef0001019a971c3b4e00db756f"><div class="ttname"><a href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ad78011ef0001019a971c3b4e00db756f">qjs::detail::get_set&lt; M &gt;::get</a></div><div class="ttdeci">static const R &amp; get(const std::shared_ptr&lt; T &gt; &amp;ptr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00776">quickjspp.hpp:776</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_a03413dce82c10c7e7680a1c64caae2c9"><div class="ttname"><a href="namespaceqjs_1_1detail.html#a03413dce82c10c7e7680a1c64caae2c9">qjs::detail::unwrap_free</a></div><div class="ttdeci">T unwrap_free(JSContext *ctx, JSValue val)</div><div class="ttdoc">Helper function to convert and then free JSValue. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00266">quickjspp.hpp:266</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_af89ba06f7b83190d4fdb775c5964dcf9"><div class="ttname"><a href="classqjs_1_1Value.html#af89ba06f7b83190d4fdb775c5964dcf9">qjs::Value::add</a></div><div class="ttdeci">std::enable_if_t&lt;!std::is_member_object_pointer_v&lt; decltype(F)&gt;, Value &amp; &gt; add(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00895">quickjspp.hpp:895</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_ab2b73998043cb498415b0797026c0c04"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#ab2b73998043cb498415b0797026c0c04">qjs::Context::Module::class_registrar::~class_registrar</a></div><div class="ttdeci">~class_registrar()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01131">quickjspp.hpp:1131</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a88246cb76492cbedf253467fb5291e5c"><div class="ttname"><a href="classqjs_1_1Context.html#a88246cb76492cbedf253467fb5291e5c">qjs::Context::addModule</a></div><div class="ttdeci">Module &amp; addModule(const char *name)</div><div class="ttdoc">Create module and return a reference to it. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01184">quickjspp.hpp:1184</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a99e7e88f8be813095ae52fa47da333b0"><div class="ttname"><a href="classqjs_1_1Value.html#a99e7e88f8be813095ae52fa47da333b0">qjs::Value::operator==</a></div><div class="ttdeci">bool operator==(const Value &amp;rhs) const</div><div class="ttdoc">Returns true if 2 values are the same (equality for arithmetic types or point to the same object) ...</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00841">quickjspp.hpp:841</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1get__set_html"><div class="ttname"><a href="structqjs_1_1detail_1_1get__set.html">qjs::detail::get_set</a></div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00769">quickjspp.hpp:769</a></div></div>
<div class="ttc" id="quickjs_8h_html_a775522f2d084fc8fa0fcb33f390006b4"><div class="ttname"><a href="quickjs_8h.html#a775522f2d084fc8fa0fcb33f390006b4">JS_DupValue</a></div><div class="ttdeci">static JSValue JS_DupValue(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00657">quickjs.h:657</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a7b2bb04c2b1d1b8959dd56c493369fe4"><div class="ttname"><a href="structqjs_1_1allocator.html#a7b2bb04c2b1d1b8959dd56c493369fe4">qjs::allocator::rt</a></div><div class="ttdeci">JSRuntime * rt</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00024">quickjspp.hpp:24</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4_html_a0a01071b0c80a16dbd7d0fa538534116"><div class="ttname"><a href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#a0a01071b0c80a16dbd7d0fa538534116">qjs::js_property_traits&lt; const char * &gt;::get_property</a></div><div class="ttdeci">static JSValue get_property(JSContext *ctx, JSValue this_obj, const char *name) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00711">quickjspp.hpp:711</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html">qjs::Context::Module</a></div><div class="ttdoc">Module wrapper Workaround for lack of opaque pointer for module load function by keeping a list of mo...</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00977">quickjspp.hpp:977</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01T_01_5_01_4_html_a1dbb626be00a1b77338c6bc7235240ee"><div class="ttname"><a href="structqjs_1_1js__traits_3_01T_01_5_01_4.html#a1dbb626be00a1b77338c6bc7235240ee">qjs::js_traits&lt; T * &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, T *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00579">quickjspp.hpp:579</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a3b27c93856e8a42e7065fd660e6f176a"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3b27c93856e8a42e7065fd660e6f176a">qjs::Context::Module::class_registrar::prototype</a></div><div class="ttdeci">qjs::Value prototype</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01066">quickjspp.hpp:1066</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_aa57193f349f84eb585eebb67c6334be1"><div class="ttname"><a href="classqjs_1_1Value.html#aa57193f349f84eb585eebb67c6334be1">qjs::Value::toJSON</a></div><div class="ttdeci">std::string toJSON(const Value &amp;replacer=Value{nullptr, JS_UNDEFINED}, const Value &amp;space=Value{nullptr, JS_UNDEFINED})</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00931">quickjspp.hpp:931</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a8d0d3600bdc9045267bfd6e8823e87c8"><div class="ttname"><a href="classqjs_1_1Value.html#a8d0d3600bdc9045267bfd6e8823e87c8">qjs::Value::as</a></div><div class="ttdeci">T as() const</div><div class="ttdoc">Conversion helper function. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00858">quickjspp.hpp:858</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1function_html_a35280302753c71bd2878fb861ac9795f"><div class="ttname"><a href="structqjs_1_1detail_1_1function.html#a35280302753c71bd2878fb861ac9795f">qjs::detail::function::destroyer</a></div><div class="ttdeci">void(* destroyer)(function *self)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00621">quickjspp.hpp:621</a></div></div>
<div class="ttc" id="quickjs_8c_html_acc3990661d2851b858601061a62cc7d6"><div class="ttname"><a href="quickjs_8c.html#acc3990661d2851b858601061a62cc7d6">JS_SetModuleExport</a></div><div class="ttdeci">int JS_SetModuleExport(JSContext *ctx, JSModuleDef *m, const char *export_name, JSValue val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l26834">quickjs.c:26834</a></div></div>
<div class="ttc" id="quickjs_8c_html_ad2256fd11b2bdbdd19ddf38f681814bd"><div class="ttname"><a href="quickjs_8c.html#ad2256fd11b2bdbdd19ddf38f681814bd">JS_GetGlobalObject</a></div><div class="ttdeci">JSValue JS_GetGlobalObject(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l06264">quickjs.c:6264</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a32e39746026838887d964868250008b4"><div class="ttname"><a href="classqjs_1_1Value.html#a32e39746026838887d964868250008b4">qjs::Value::v</a></div><div class="ttdeci">JSValue v</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00800">quickjspp.hpp:800</a></div></div>
<div class="ttc" id="quickjs_8c_html_a853f0924d441ea4225488f37c8b69f9a"><div class="ttname"><a href="quickjs_8c.html#a853f0924d441ea4225488f37c8b69f9a">__attribute__</a></div><div class="ttdeci">JSValue __attribute__((format(printf, 2, 3)))</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01005">quickjs.c:1005</a></div></div>
<div class="ttc" id="quickjs_8c_html_a5644dc5dba0d760dcc06cc1a79e256cc"><div class="ttname"><a href="quickjs_8c.html#a5644dc5dba0d760dcc06cc1a79e256cc">JS_GetOpaque</a></div><div class="ttdeci">void * JS_GetOpaque(JSValueConst obj, JSClassID class_id)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l09704">quickjs.c:9704</a></div></div>
<div class="ttc" id="quickjs_8c_html_aeb97957655d979e9fe56c955da2b2d4b"><div class="ttname"><a href="quickjs_8c.html#aeb97957655d979e9fe56c955da2b2d4b">JS_GetPropertyUint32</a></div><div class="ttdeci">JSValue JS_GetPropertyUint32(JSContext *ctx, JSValueConst this_obj, uint32_t idx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l07836">quickjs.c:7836</a></div></div>
<div class="ttc" id="quickjs_8c_html_aae909eaec829081b270012adfcd717a4"><div class="ttname"><a href="quickjs_8c.html#aae909eaec829081b270012adfcd717a4">JS_SetPropertyUint32</a></div><div class="ttdeci">int JS_SetPropertyUint32(JSContext *ctx, JSValueConst this_obj, uint32_t idx, JSValue val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l08689">quickjs.c:8689</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_a922d8f54f950806452ca4afdc179f5a0"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#a922d8f54f950806452ca4afdc179f5a0">qjs::detail::property_proxy::ctx</a></div><div class="ttdeci">JSContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00739">quickjspp.hpp:739</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01detail_1_1function_01_4_html_ad00ea7f7fc3428ef6f8bae9fe4cc6ea5"><div class="ttname"><a href="structqjs_1_1js__traits_3_01detail_1_1function_01_4.html#ad00ea7f7fc3428ef6f8bae9fe4cc6ea5">qjs::js_traits&lt; detail::function &gt;::QJSClassId</a></div><div class="ttdeci">static JSClassID QJSClassId</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00652">quickjspp.hpp:652</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a615b7f44778ba84c409e73e66c93d7d4"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a615b7f44778ba84c409e73e66c93d7d4">qjs::Context::Module::Module</a></div><div class="ttdeci">Module(const Module &amp;)=delete</div></div>
<div class="ttc" id="structqjs_1_1js__traits_html_af5c423e9b466ada685a39ac2dd5d2934"><div class="ttname"><a href="structqjs_1_1js__traits.html#af5c423e9b466ada685a39ac2dd5d2934">qjs::js_traits::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, R value)</div><div class="ttdoc">Create JSValue from an object of type R and JSContext. </div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4_html_a0a1cc387d5c49e5cb5ae417730d32b1c"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a0a1cc387d5c49e5cb5ae417730d32b1c">qjs::js_traits&lt; std::vector&lt; T &gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, const std::vector&lt; T &gt; &amp;arr) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01310">quickjspp.hpp:1310</a></div></div>
<div class="ttc" id="quickjs_8h_html_ae91f44bd7249613050c18c7133702c67"><div class="ttname"><a href="quickjs_8h.html#ae91f44bd7249613050c18c7133702c67">JS_NewFloat64</a></div><div class="ttdeci">static js_force_inline JSValue JS_NewFloat64(JSContext *ctx, double d)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00539">quickjs.h:539</a></div></div>
<div class="ttc" id="quickjs_8h_html_a1e7f56471f8608df9405987087a56070"><div class="ttname"><a href="quickjs_8h.html#a1e7f56471f8608df9405987087a56070">JS_ToCStringLen</a></div><div class="ttdeci">static const char * JS_ToCStringLen(JSContext *ctx, size_t *plen, JSValueConst val1)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00695">quickjs.h:695</a></div></div>
<div class="ttc" id="quickjs_8h_html_ac6d59bf69724330a254181bca0519dac"><div class="ttname"><a href="quickjs_8h.html#ac6d59bf69724330a254181bca0519dac">JS_PROP_CONFIGURABLE</a></div><div class="ttdeci">#define JS_PROP_CONFIGURABLE</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00263">quickjs.h:263</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a3d44c8a62385adeb9248cb38ae0168da"><div class="ttname"><a href="classqjs_1_1Context.html#a3d44c8a62385adeb9248cb38ae0168da">qjs::Context::getException</a></div><div class="ttdeci">Value getException()</div><div class="ttdoc">returns current exception associated with context, and resets it. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01201">quickjspp.hpp:1201</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4_html_ad7131d2b5de0ffc36fba2524b6d88f11"><div class="ttname"><a href="structqjs_1_1js__property__traits_3_01const_01char_01_5_01_4.html#ad7131d2b5de0ffc36fba2524b6d88f11">qjs::js_property_traits&lt; const char * &gt;::set_property</a></div><div class="ttdeci">static void set_property(JSContext *ctx, JSValue this_obj, const char *name, JSValue value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00704">quickjspp.hpp:704</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4_html_a70d968ba4279b45ace24740746d90eff"><div class="ttname"><a href="structqjs_1_1js__traits_3_01fwrapper_3_01F_01_4_01_4.html#a70d968ba4279b45ace24740746d90eff">qjs::js_traits&lt; fwrapper&lt; F &gt; &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, fwrapper&lt; F &gt; fw) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00427">quickjspp.hpp:427</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_a256f35584ca0565461b092c78d2206dd"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#a256f35584ca0565461b092c78d2206dd">qjs::detail::property_proxy::this_obj</a></div><div class="ttdeci">JSValue this_obj</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00740">quickjspp.hpp:740</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_html"><div class="ttname"><a href="structqjs_1_1js__property__traits.html">qjs::js_property_traits</a></div><div class="ttdoc">Traits for accessing object properties. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00695">quickjspp.hpp:695</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html">qjs::detail::property_proxy</a></div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00737">quickjspp.hpp:737</a></div></div>
<div class="ttc" id="quickjs_8c_html_a742ee8af627e4502758e503d152b0cd0"><div class="ttname"><a href="quickjs_8c.html#a742ee8af627e4502758e503d152b0cd0">JS_SetClassProto</a></div><div class="ttdeci">void JS_SetClassProto(JSContext *ctx, JSClassID class_id, JSValue obj)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02174">quickjs.c:2174</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html"><div class="ttname"><a href="classqjs_1_1Value.html">qjs::Value</a></div><div class="ttdoc">JSValue with RAAI semantics. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00797">quickjspp.hpp:797</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_af3540347ff540edef984e18afb7c8b24"><div class="ttname"><a href="structqjs_1_1allocator.html#af3540347ff540edef984e18afb7c8b24">qjs::allocator::deallocate</a></div><div class="ttdeci">void deallocate(T *p, std::size_t) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00045">quickjspp.hpp:45</a></div></div>
<div class="ttc" id="quickjs_8c_html_afc9f16af1ddbee548aa05ae2d28dcd16"><div class="ttname"><a href="quickjs_8c.html#afc9f16af1ddbee548aa05ae2d28dcd16">JS_IsError</a></div><div class="ttdeci">BOOL JS_IsError(JSContext *ctx, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l09660">quickjs.c:9660</a></div></div>
<div class="ttc" id="quickjs-libc_8c_html_a529207225a77f71253f17893e1e6dffb"><div class="ttname"><a href="quickjs-libc_8c.html#a529207225a77f71253f17893e1e6dffb">js_load_file</a></div><div class="ttdeci">uint8_t * js_load_file(JSContext *ctx, size_t *pbuf_len, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs-libc_8c_source.html#l00361">quickjs-libc.c:361</a></div></div>
<div class="ttc" id="classqjs_1_1exception_html"><div class="ttname"><a href="classqjs_1_1exception.html">qjs::exception</a></div><div class="ttdoc">Exception type. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00059">quickjspp.hpp:59</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a35458ca61a5e1207ea5a2ea244290af9"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a35458ca61a5e1207ea5a2ea244290af9">qjs::Context::Module::exports</a></div><div class="ttdeci">std::vector&lt; nvp, allocator&lt; nvp &gt; &gt; exports</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00986">quickjspp.hpp:986</a></div></div>
<div class="ttc" id="quickjs_8c_html_a525bb5bdbab2566313d9bcd876838d9d"><div class="ttname"><a href="quickjs_8c.html#a525bb5bdbab2566313d9bcd876838d9d">JS_ToBool</a></div><div class="ttdeci">int JS_ToBool(JSContext *ctx, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l09857">quickjs.c:9857</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1get__set_3_01M_01_4_html_ae3c3f195e157f6114e3e0fb66e50d2b9"><div class="ttname"><a href="structqjs_1_1detail_1_1get__set_3_01M_01_4.html#ae3c3f195e157f6114e3e0fb66e50d2b9">qjs::detail::get_set&lt; M &gt;::set</a></div><div class="ttdeci">static R &amp; set(const std::shared_ptr&lt; T &gt; &amp;ptr, R value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00781">quickjspp.hpp:781</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4_html_a9381fc53f1eaf830b702453ca29655f2"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1vector_3_01T_01_4_01_4.html#a9381fc53f1eaf830b702453ca29655f2">qjs::js_traits&lt; std::vector&lt; T &gt; &gt;::unwrap</a></div><div class="ttdeci">static std::vector&lt; T &gt; unwrap(JSContext *ctx, JSValueConst jsarr)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01328">quickjspp.hpp:1328</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a935a485219f916949913ca0da81d6692"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a935a485219f916949913ca0da81d6692">qjs::Context::Module::class_registrar::constructor</a></div><div class="ttdeci">class_registrar &amp; constructor(const char *name=nullptr)</div><div class="ttdoc">Add class constructor. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01107">quickjspp.hpp:1107</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_aa1275678b079d880cd9f2477552c90a5"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#aa1275678b079d880cd9f2477552c90a5">qjs::Context::Module::function</a></div><div class="ttdeci">Module &amp; function(const char *name, F &amp;&amp;f)</div><div class="ttdoc">Add function object f. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01051">quickjspp.hpp:1051</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1string_01_4_html_ac5b51c364766cc6e173eb6fb473bca98"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1string_01_4.html#ac5b51c364766cc6e173eb6fb473bca98">qjs::js_traits&lt; std::string &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, const std::string &amp;str) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00241">quickjspp.hpp:241</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a003bfbb1ead4106d2f1fad18cedbdad1"><div class="ttname"><a href="classqjs_1_1Context.html#a003bfbb1ead4106d2f1fad18cedbdad1">qjs::Context::evalFile</a></div><div class="ttdeci">Value evalFile(const char *filename, unsigned eval_flags=0)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01222">quickjspp.hpp:1222</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a02471b1f0c7cd372d9bf547d24fe9720"><div class="ttname"><a href="classqjs_1_1Context.html#a02471b1f0c7cd372d9bf547d24fe9720">qjs::Context::ctx</a></div><div class="ttdeci">JSContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00972">quickjspp.hpp:972</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_ab84e72a846bceb8085366950bb328548"><div class="ttname"><a href="classqjs_1_1Context.html#ab84e72a846bceb8085366950bb328548">qjs::Context::newObject</a></div><div class="ttdeci">Value newObject()</div><div class="ttdoc">returns new Object() </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01194">quickjspp.hpp:1194</a></div></div>
<div class="ttc" id="quickjs_8c_html_a2da4d4ea8b060716bf80ca5808043a0b"><div class="ttname"><a href="quickjs_8c.html#a2da4d4ea8b060716bf80ca5808043a0b">JS_GetContextOpaque</a></div><div class="ttdeci">void * JS_GetContextOpaque(JSContext *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02154">quickjs.c:2154</a></div></div>
<div class="ttc" id="structqjs_1_1js__property__traits_3_01uint32__t_01_4_html_a80956064f81774837d511e8321056418"><div class="ttname"><a href="structqjs_1_1js__property__traits_3_01uint32__t_01_4.html#a80956064f81774837d511e8321056418">qjs::js_property_traits&lt; uint32_t &gt;::set_property</a></div><div class="ttdeci">static void set_property(JSContext *ctx, JSValue this_obj, uint32_t idx, JSValue value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00720">quickjspp.hpp:720</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a8e2a5be6c89f30cee044b884e30bf819"><div class="ttname"><a href="classqjs_1_1Value.html#a8e2a5be6c89f30cee044b884e30bf819">qjs::Value::Value</a></div><div class="ttdeci">Value(JSContext *ctx, T &amp;&amp;val)</div><div class="ttdoc">Use context.newValue(val) instead. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00806">quickjspp.hpp:806</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_abfd1fa6f49f2743081f7d4ee80bcad90"><div class="ttname"><a href="classqjs_1_1Context.html#abfd1fa6f49f2743081f7d4ee80bcad90">qjs::Context::get</a></div><div class="ttdeci">static Context &amp; get(JSContext *ctx)</div><div class="ttdoc">Get qjs::Context from JSContext opaque pointer. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01240">quickjspp.hpp:1240</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_aaf15ddf408ae1f1d6d6c320f78986d12"><div class="ttname"><a href="classqjs_1_1Value.html#aaf15ddf408ae1f1d6d6c320f78986d12">qjs::Value::operator=</a></div><div class="ttdeci">Value &amp; operator=(Value rhs)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00825">quickjspp.hpp:825</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_a7c336da9a39cda78d9b67512812c5568"><div class="ttname"><a href="namespaceqjs_1_1detail.html#a7c336da9a39cda78d9b67512812c5568">qjs::detail::wrap_args_impl</a></div><div class="ttdeci">void wrap_args_impl(JSContext *ctx, JSValue *argv, Tuple tuple, std::index_sequence&lt; I... &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00363">quickjspp.hpp:363</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_a6ad2518f4aad0751fdb7d09727c8ac9d"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#a6ad2518f4aad0751fdb7d09727c8ac9d">qjs::Context::Module::class_</a></div><div class="ttdeci">class_registrar&lt; T &gt; class_(const char *name)</div><div class="ttdoc">Add class to module. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01142">quickjspp.hpp:1142</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_html_a4e5cec13ad1a12540908cff4feb6a2da"><div class="ttname"><a href="structqjs_1_1js__traits.html#a4e5cec13ad1a12540908cff4feb6a2da">qjs::js_traits::unwrap</a></div><div class="ttdeci">static R unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdoc">Create an object of C++ type R given JSValue v and JSContext. </div></div>
<div class="ttc" id="quickjs_8c_html_a8cc9386cd04cfa067d0c6bf588c6bb58"><div class="ttname"><a href="quickjs_8c.html#a8cc9386cd04cfa067d0c6bf588c6bb58">JS_ToFloat64</a></div><div class="ttdeci">int JS_ToFloat64(JSContext *ctx, double *pres, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l10447">quickjs.c:10447</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1string__view_01_4_html_a722fb92e222abf0655072de681e46b23"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1string__view_01_4.html#a722fb92e222abf0655072de681e46b23">qjs::js_traits&lt; std::string_view &gt;::unwrap</a></div><div class="ttdeci">static detail::js_string unwrap(JSContext *ctx, JSValueConst v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00216">quickjspp.hpp:216</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_a01f1f28aee483207a570f6f6e2704ebc"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#a01f1f28aee483207a570f6f6e2704ebc">qjs::detail::property_proxy::operator=</a></div><div class="ttdeci">property_proxy &amp; operator=(Value value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00758">quickjspp.hpp:758</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a37173af959da7e4188e228aa95f8f90f"><div class="ttname"><a href="classqjs_1_1Value.html#a37173af959da7e4188e228aa95f8f90f">qjs::Value::Value</a></div><div class="ttdeci">Value(const Value &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00813">quickjspp.hpp:813</a></div></div>
<div class="ttc" id="quickjs_8h_html_ac363230cf3ec220f5788a1f85976f205"><div class="ttname"><a href="quickjs_8h.html#ac363230cf3ec220f5788a1f85976f205">JS_UNDEFINED</a></div><div class="ttdeci">#define JS_UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00256">quickjs.h:256</a></div></div>
<div class="ttc" id="quickjs_8c_html_aa28cb15ab0d131c2d312dd3fe3ddcb07"><div class="ttname"><a href="quickjs_8c.html#aa28cb15ab0d131c2d312dd3fe3ddcb07">JS_SetContextOpaque</a></div><div class="ttdeci">void JS_SetContextOpaque(JSContext *ctx, void *opaque)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02159">quickjs.c:2159</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_adc20edb42e1c8f5ef2da071d258410dc"><div class="ttname"><a href="classqjs_1_1Context.html#adc20edb42e1c8f5ef2da071d258410dc">qjs::Context::registerClass</a></div><div class="ttdeci">void registerClass(const char *name, JSValue proto=JS_NULL)</div><div class="ttdoc">Register class T for conversions to/from std::shared_ptr&lt;T&gt; to work. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01210">quickjspp.hpp:1210</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_ace3f753ae2ad418064ea2d2382579a9d"><div class="ttname"><a href="classqjs_1_1Context.html#ace3f753ae2ad418064ea2d2382579a9d">qjs::Context::fromJSON</a></div><div class="ttdeci">Value fromJSON(std::string_view buffer, const char *filename=&quot;&lt;fromJSON&gt;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01232">quickjspp.hpp:1232</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_1_1class__registrar_html_a3ce7ca743f2d5a4b6bce2c0bd54c88e9"><div class="ttname"><a href="classqjs_1_1Context_1_1Module_1_1class__registrar.html#a3ce7ca743f2d5a4b6bce2c0bd54c88e9">qjs::Context::Module::class_registrar::fun</a></div><div class="ttdeci">class_registrar &amp; fun(const char *name, F &amp;&amp;f)</div><div class="ttdoc">Add functional object f. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01083">quickjspp.hpp:1083</a></div></div>
<div class="ttc" id="namespaceqjs_1_1detail_html_a0aa844300f88bcbc400ab4cf109a9fe4"><div class="ttname"><a href="namespaceqjs_1_1detail.html#a0aa844300f88bcbc400ab4cf109a9fe4">qjs::detail::unwrap_args_impl</a></div><div class="ttdeci">Tuple unwrap_args_impl(JSContext *ctx, JSValueConst *argv, std::index_sequence&lt; I... &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00289">quickjspp.hpp:289</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4_html_af3558afeef079826c58411353c8ccce0"><div class="ttname"><a href="structqjs_1_1js__traits_3_01std_1_1shared__ptr_3_01T_01_4_01_4.html#af3558afeef079826c58411353c8ccce0">qjs::js_traits&lt; std::shared_ptr&lt; T &gt; &gt;::register_class</a></div><div class="ttdeci">static void register_class(JSContext *ctx, const char *name, JSValue proto=JS_NULL)</div><div class="ttdoc">Register class in QuickJS context. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00507">quickjspp.hpp:507</a></div></div>
<div class="ttc" id="quickjs_8h_html_acfa4fd7848997fa4af3ee04a2f63aac7"><div class="ttname"><a href="quickjs_8h.html#acfa4fd7848997fa4af3ee04a2f63aac7">JS_VALUE_GET_TAG</a></div><div class="ttdeci">#define JS_VALUE_GET_TAG(v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00210">quickjs.h:210</a></div></div>
<div class="ttc" id="quickjs_8h_html_aba884d678110c142e1340ac3f1ab4ada"><div class="ttname"><a href="quickjs_8h.html#aba884d678110c142e1340ac3f1ab4ada">JS_EXCEPTION</a></div><div class="ttdeci">#define JS_EXCEPTION</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00259">quickjs.h:259</a></div></div>
<div class="ttc" id="quickjs_8c_html_afc1ca27a266094085ebb43e2eea0dda2"><div class="ttname"><a href="quickjs_8c.html#afc1ca27a266094085ebb43e2eea0dda2">JS_NewRuntime</a></div><div class="ttdeci">JSRuntime * JS_NewRuntime(void)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l01747">quickjs.c:1747</a></div></div>
<div class="ttc" id="structqjs_1_1fwrapper_html"><div class="ttname"><a href="structqjs_1_1fwrapper.html">qjs::fwrapper</a></div><div class="ttdoc">A wrapper type for free and class member functions. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00386">quickjspp.hpp:386</a></div></div>
<div class="ttc" id="quickjs_8c_html_a4073bd2b4f247bf6077cd956759193b9"><div class="ttname"><a href="quickjs_8c.html#a4073bd2b4f247bf6077cd956759193b9">JS_ToInt32</a></div><div class="ttdeci">int JS_ToInt32(JSContext *ctx, int32_t *pres, JSValueConst val)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l10804">quickjs.c:10804</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_af725fb8083d8c33a37198d6acaf1a836"><div class="ttname"><a href="classqjs_1_1Context.html#af725fb8083d8c33a37198d6acaf1a836">qjs::Context::Context</a></div><div class="ttdeci">Context(Runtime &amp;rt)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01158">quickjspp.hpp:1158</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a18001b399a7e0a993ac9c839ebfe691c"><div class="ttname"><a href="structqjs_1_1allocator.html#a18001b399a7e0a993ac9c839ebfe691c">qjs::allocator::allocator</a></div><div class="ttdeci">allocator(JSContext *ctx) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00032">quickjspp.hpp:32</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html"><div class="ttname"><a href="classqjs_1_1Context.html">qjs::Context</a></div><div class="ttdoc">Wrapper over JSContext * ctx Calls JS_SetContextOpaque(ctx, this); on construction and JS_FreeContext...</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00969">quickjspp.hpp:969</a></div></div>
<div class="ttc" id="quickjs_8c_html_a85a2abf65c29c82c085c9b7430538096"><div class="ttname"><a href="quickjs_8c.html#a85a2abf65c29c82c085c9b7430538096">JS_ParseJSON</a></div><div class="ttdeci">JSValue JS_ParseJSON(JSContext *ctx, const char *buf, size_t buf_len, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l43027">quickjs.c:43027</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1property__proxy_html_af5ab01d0154d84c8f16e93563a37db16"><div class="ttname"><a href="structqjs_1_1detail_1_1property__proxy.html#af5ab01d0154d84c8f16e93563a37db16">qjs::detail::property_proxy::operator Value</a></div><div class="ttdeci">operator Value() const</div><div class="ttdoc">Implicit converion to qjs::Value. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01347">quickjspp.hpp:1347</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_ad7677a3e42f8c82bb64b5633a611f2f6"><div class="ttname"><a href="classqjs_1_1Value.html#ad7677a3e42f8c82bb64b5633a611f2f6">qjs::Value::release</a></div><div class="ttdeci">JSValue release()</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00864">quickjspp.hpp:864</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a3c7a430d70a4efb5305a3fcfda56b2a4"><div class="ttname"><a href="structqjs_1_1allocator.html#a3c7a430d70a4efb5305a3fcfda56b2a4">qjs::allocator::allocate</a></div><div class="ttdeci">T * allocate(std::size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00039">quickjspp.hpp:39</a></div></div>
<div class="ttc" id="quickjs_8c_html_a0ee6a3654a6016393fac5e1c108f403a"><div class="ttname"><a href="quickjs_8c.html#a0ee6a3654a6016393fac5e1c108f403a">JS_NewString</a></div><div class="ttdeci">JSValue JS_NewString(JSContext *ctx, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03918">quickjs.c:3918</a></div></div>
<div class="ttc" id="quickjs_8c_html_a659dc0db7e440fd6eb012d613627faa3"><div class="ttname"><a href="quickjs_8c.html#a659dc0db7e440fd6eb012d613627faa3">JS_NewObjectClass</a></div><div class="ttdeci">JSValue JS_NewObjectClass(JSContext *ctx, int class_id)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l04852">quickjs.c:4852</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01JSValue_01_4_html_abfff1cf9eaa513adad29c9f1122f3dc2"><div class="ttname"><a href="structqjs_1_1js__traits_3_01JSValue_01_4.html#abfff1cf9eaa513adad29c9f1122f3dc2">qjs::js_traits&lt; JSValue &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, JSValue v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00090">quickjspp.hpp:90</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a4392a23648acfc4bf6b445336efb5007"><div class="ttname"><a href="classqjs_1_1Context.html#a4392a23648acfc4bf6b445336efb5007">qjs::Context::Context</a></div><div class="ttdeci">Context(JSRuntime *rt)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01161">quickjspp.hpp:1161</a></div></div>
<div class="ttc" id="classqjs_1_1Context_html_a2275ad206587ece12d220fb8ed0c0744"><div class="ttname"><a href="classqjs_1_1Context.html#a2275ad206587ece12d220fb8ed0c0744">qjs::Context::global</a></div><div class="ttdeci">Value global()</div><div class="ttdoc">returns globalThis </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01191">quickjspp.hpp:1191</a></div></div>
<div class="ttc" id="classqjs_1_1Value_html_a4abc02a924e2c5085c09c60417243aec"><div class="ttname"><a href="classqjs_1_1Value.html#a4abc02a924e2c5085c09c60417243aec">qjs::Value::add</a></div><div class="ttdeci">Value &amp; add(const char *name, Function &amp;&amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00884">quickjspp.hpp:884</a></div></div>
<div class="ttc" id="quickjs_8c_html_ad8aedb643b8753b7a15f6cb2df61945e"><div class="ttname"><a href="quickjs_8c.html#ad8aedb643b8753b7a15f6cb2df61945e">JS_NewContext</a></div><div class="ttdeci">JSContext * JS_NewContext(JSRuntime *rt)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l02130">quickjs.c:2130</a></div></div>
<div class="ttc" id="classqjs_1_1Runtime_html_a3b498d71f948fb1e1dff1b1d34159fb4"><div class="ttname"><a href="classqjs_1_1Runtime.html#a3b498d71f948fb1e1dff1b1d34159fb4">qjs::Runtime::rt</a></div><div class="ttdeci">JSRuntime * rt</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00948">quickjspp.hpp:948</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_aa51896e065a04689c9dbe80a282805bb"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#aa51896e065a04689c9dbe80a282805bb">qjs::Context::Module::add</a></div><div class="ttdeci">Module &amp; add(const char *name, JSValue value)</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l01007">quickjspp.hpp:1007</a></div></div>
<div class="ttc" id="structqjs_1_1ctor__wrapper_html_ac23fa7c418fd0f0a1531365f6b78f679"><div class="ttname"><a href="structqjs_1_1ctor__wrapper.html#ac23fa7c418fd0f0a1531365f6b78f679">qjs::ctor_wrapper::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">&quot;name&quot; property of JS constructor object </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00446">quickjspp.hpp:446</a></div></div>
<div class="ttc" id="quickjs_8c_html_a9f0339d81c06451de278073572cc194e"><div class="ttname"><a href="quickjs_8c.html#a9f0339d81c06451de278073572cc194e">JS_NewClass</a></div><div class="ttdeci">int JS_NewClass(JSRuntime *rt, JSClassID class_id, const JSClassDef *class_def)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03404">quickjs.c:3404</a></div></div>
<div class="ttc" id="quickjs_8h_html_a191efd2d7aab4362bf3c9e2049402e72ad7162837bf33ab604fb2cac5f3892ca7"><div class="ttname"><a href="quickjs_8h.html#a191efd2d7aab4362bf3c9e2049402e72ad7162837bf33ab604fb2cac5f3892ca7">JS_CFUNC_constructor</a></div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8h_source.html#l00893">quickjs.h:893</a></div></div>
<div class="ttc" id="structqjs_1_1detail_1_1function_html_a4e9a1c593dbda40eac7778e34f472f8b"><div class="ttname"><a href="structqjs_1_1detail_1_1function.html#a4e9a1c593dbda40eac7778e34f472f8b">qjs::detail::function::functor</a></div><div class="ttdeci">char functor[]</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00623">quickjspp.hpp:623</a></div></div>
<div class="ttc" id="classqjs_1_1Context_1_1Module_html_ac5cb4bf9261a549af817cff3e65abc9c"><div class="ttname"><a href="classqjs_1_1Context_1_1Module.html#ac5cb4bf9261a549af817cff3e65abc9c">qjs::Context::Module::ctx</a></div><div class="ttdeci">JSContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00982">quickjspp.hpp:982</a></div></div>
<div class="ttc" id="structqjs_1_1js__traits_3_01const_01char_01_5_01_4_html_ae1a13e887841edd9c73cc2ea8e72d7bb"><div class="ttname"><a href="structqjs_1_1js__traits_3_01const_01char_01_5_01_4.html#ae1a13e887841edd9c73cc2ea8e72d7bb">qjs::js_traits&lt; const char * &gt;::wrap</a></div><div class="ttdeci">static JSValue wrap(JSContext *ctx, const char *str) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00251">quickjspp.hpp:251</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html"><div class="ttname"><a href="structqjs_1_1allocator.html">qjs::allocator</a></div><div class="ttdoc">A custom allocator that uses js_malloc_rt and js_free_rt. </div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00022">quickjspp.hpp:22</a></div></div>
<div class="ttc" id="quickjs_8c_html_ab7fc45a99935a1c0ba50b0216d9401a9"><div class="ttname"><a href="quickjs_8c.html#ab7fc45a99935a1c0ba50b0216d9401a9">JS_FreeAtom</a></div><div class="ttdeci">void JS_FreeAtom(JSContext *ctx, JSAtom v)</div><div class="ttdef"><b>Definition:</b> <a href="quickjs_8c_source.html#l03209">quickjs.c:3209</a></div></div>
<div class="ttc" id="structqjs_1_1allocator_html_a1ecbd6cbf9dbe963b1b13ce47d33cd7e"><div class="ttname"><a href="structqjs_1_1allocator.html#a1ecbd6cbf9dbe963b1b13ce47d33cd7e">qjs::allocator::operator==</a></div><div class="ttdeci">bool operator==(const allocator&lt; U &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="quickjspp_8hpp_source.html#l00049">quickjspp.hpp:49</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
